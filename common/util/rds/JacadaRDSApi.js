"use strict";
/**
 * Raw Data Service API
 * Raw data service (aka rds) API's documentation
 *
 * OpenAPI spec version: 1.0.0
 *
 *
 * NOTE: This class is auto generated by the swagger code generator program.
 * https://github.com/swagger-api/swagger-codegen.git
 * Do not edit the class manually.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const request = require("request");
const Promise = require("bluebird");
let defaultBasePath = 'https://gointeract.io/rds';
// ===============================================
// This file is autogenerated - Please do not edit
// ===============================================
/* tslint:disable:no-unused-variable */
class AggregationCreateResponse {
}
exports.AggregationCreateResponse = AggregationCreateResponse;
class AggregationDTO {
}
exports.AggregationDTO = AggregationDTO;
class AggregationResponse {
}
exports.AggregationResponse = AggregationResponse;
class BatchResponse {
}
exports.BatchResponse = BatchResponse;
class CustomerDTO {
}
exports.CustomerDTO = CustomerDTO;
class EventDTO {
}
exports.EventDTO = EventDTO;
class FieldDTO {
}
exports.FieldDTO = FieldDTO;
class PageDTO {
}
exports.PageDTO = PageDTO;
class QueryFieldsDTO {
}
exports.QueryFieldsDTO = QueryFieldsDTO;
class TenantInfoDTO {
}
exports.TenantInfoDTO = TenantInfoDTO;
class TransactionDTO {
}
exports.TransactionDTO = TransactionDTO;
class Variable {
}
exports.Variable = Variable;
class VariableDTO {
}
exports.VariableDTO = VariableDTO;
class VariableValue {
}
exports.VariableValue = VariableValue;
class HttpBasicAuth {
    applyToRequest(requestOptions) {
        requestOptions.auth = {
            username: this.username, password: this.password
        };
    }
}
exports.HttpBasicAuth = HttpBasicAuth;
class ApiKeyAuth {
    constructor(location, paramName) {
        this.location = location;
        this.paramName = paramName;
    }
    applyToRequest(requestOptions) {
        if (this.location == "query") {
            requestOptions.qs[this.paramName] = this.apiKey;
        }
        else if (this.location == "header" && requestOptions && requestOptions.headers) {
            requestOptions.headers[this.paramName] = this.apiKey;
        }
    }
}
exports.ApiKeyAuth = ApiKeyAuth;
class OAuth {
    applyToRequest(requestOptions) {
        if (requestOptions && requestOptions.headers) {
            requestOptions.headers["Authorization"] = "Bearer " + this.accessToken;
        }
    }
}
exports.OAuth = OAuth;
class VoidAuth {
    applyToRequest(_) {
        // Do nothing
    }
}
exports.VoidAuth = VoidAuth;
var AggregationcontrollerApiApiKeys;
(function (AggregationcontrollerApiApiKeys) {
})(AggregationcontrollerApiApiKeys = exports.AggregationcontrollerApiApiKeys || (exports.AggregationcontrollerApiApiKeys = {}));
class AggregationcontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[AggregationcontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Aggregates raw data by given query.   If the query is invalid HTTP code 406 is returned
     * @summary Aggregates raw data
     * @param applicationKey RDS application key
     * @param aggregationDTO AggregationDTO includes the Aggregation query.   The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;, &#39;startTimestamp&#39; and &#39;endTimestamp&#39; in $match stage
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    aggregate(applicationKey, aggregationDTO, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling aggregate.');
        }
        // verify required parameter 'aggregationDTO' is not null or undefined
        if (aggregationDTO === null || aggregationDTO === undefined) {
            throw new Error('Required parameter aggregationDTO was null or undefined when calling aggregate.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling aggregate.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: aggregationDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Returns aggregated data by given query.   If the query is invalid HTTP code 406 is returned
     * @summary Retrieves aggregated data
     * @param applicationKey RDS application key
     * @param query Aggregation query.  The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;
     * @param aggregationId Aggregation definition id
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    aggregationRetrieve(applicationKey, query, aggregationId, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/results/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling aggregationRetrieve.');
        }
        // verify required parameter 'query' is not null or undefined
        if (query === null || query === undefined) {
            throw new Error('Required parameter query was null or undefined when calling aggregationRetrieve.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling aggregationRetrieve.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling aggregationRetrieve.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: query,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * For testing the aggregation query before calling the aggregate API.  Will run the query on the past 4 hours and will return the results of the aggregation.  If the query is invalid HTTP code 406 is returned
     * @summary Tests aggregation query of raw data
     * @param applicationKey RDS application key
     * @param query Aggregation test query.  The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;, &#39;startTimestamp&#39; and &#39;endTimestamp&#39; in $match stage
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    aggregationTest(applicationKey, query, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/test';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling aggregationTest.');
        }
        // verify required parameter 'query' is not null or undefined
        if (query === null || query === undefined) {
            throw new Error('Required parameter query was null or undefined when calling aggregationTest.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling aggregationTest.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: query,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Deletes aggregation by id, if the the aggregation not exists HTTP code 404 returned
     * @summary Deletes a specific aggregation in RDS
     * @param applicationKey
     * @param aggregationId The aggregation ID
     * @param tenantId
     * @param env
     */
    deleteAggregation(applicationKey, aggregationId, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling deleteAggregation.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling deleteAggregation.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling deleteAggregation.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'DELETE',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Returns aggregated data by given query.
     * @summary Retrieves aggregated data by find query
     * @param applicationKey RDS application key
     * @param queryFieldsDTO Fields to use in the find query.
     * @param aggregationId Aggregation definition id
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    findQueryRetrieve(applicationKey, queryFieldsDTO, aggregationId, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/results/simple/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling findQueryRetrieve.');
        }
        // verify required parameter 'queryFieldsDTO' is not null or undefined
        if (queryFieldsDTO === null || queryFieldsDTO === undefined) {
            throw new Error('Required parameter queryFieldsDTO was null or undefined when calling findQueryRetrieve.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling findQueryRetrieve.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling findQueryRetrieve.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: queryFieldsDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Get list of aggregations created for tenant
     * @summary Gets list of aggregations
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    getAggregations(applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getAggregations.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getAggregations.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Updates aggregation by id, if the the aggregation not exists HTTP code 404 returned
     * @summary Updates a specific aggregation in RDS
     * @param applicationKey
     * @param aggregationId The aggregation ID
     * @param aggregationDTO AggregationDTO includes the Aggregation query.   The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;, &#39;startTimestamp&#39; and &#39;endTimestamp&#39; in $match stage
     * @param tenantId
     * @param env
     */
    updateAggregation(applicationKey, aggregationId, aggregationDTO, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateAggregation.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling updateAggregation.');
        }
        // verify required parameter 'aggregationDTO' is not null or undefined
        if (aggregationDTO === null || aggregationDTO === undefined) {
            throw new Error('Required parameter aggregationDTO was null or undefined when calling updateAggregation.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateAggregation.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: aggregationDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.AggregationcontrollerApi = AggregationcontrollerApi;
var CustomercontrollerApiApiKeys;
(function (CustomercontrollerApiApiKeys) {
})(CustomercontrollerApiApiKeys = exports.CustomercontrollerApiApiKeys || (exports.CustomercontrollerApiApiKeys = {}));
class CustomercontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[CustomercontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Creates the customer in RDS from the CustomerDTO in the body and return HTTP code 201 (created)
     * @summary Creates customer in RDS
     * @param applicationKey
     * @param customerDto The customer body
     * @param tenantId
     * @param env
     */
    createCustomer(applicationKey, customerDto, tenantId, env) {
        const localVarPath = this.basePath + '/customers';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createCustomer.');
        }
        // verify required parameter 'customerDto' is not null or undefined
        if (customerDto === null || customerDto === undefined) {
            throw new Error('Required parameter customerDto was null or undefined when calling createCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: customerDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Deletes customer by id, if the the customer not exists HTTP code 404 returned
     * @summary Deletes a customer in RDS
     * @param applicationKey
     * @param customerId The customer ID
     * @param tenantId
     * @param env
     */
    deleteCustomer(applicationKey, customerId, tenantId, env) {
        const localVarPath = this.basePath + '/customers/{customerId}'
            .replace('{' + 'customerId' + '}', String(customerId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling deleteCustomer.');
        }
        // verify required parameter 'customerId' is not null or undefined
        if (customerId === null || customerId === undefined) {
            throw new Error('Required parameter customerId was null or undefined when calling deleteCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling deleteCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'DELETE',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads the customer from RDS by customer id, if the customer not exists in RDS, HTTP error 404 returned
     * @summary Gets specific customer from RDS by customer id
     * @param applicationKey
     * @param customerId The customer ID
     * @param tenantId
     * @param env
     */
    readCustomer(applicationKey, customerId, tenantId, env) {
        const localVarPath = this.basePath + '/customers/{customerId}'
            .replace('{' + 'customerId' + '}', String(customerId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling readCustomer.');
        }
        // verify required parameter 'customerId' is not null or undefined
        if (customerId === null || customerId === undefined) {
            throw new Error('Required parameter customerId was null or undefined when calling readCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling readCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Using customer id and CustomerDTO will update the spcific customer and return HTTP code 200 if success or if the customer not found HTTP code 404
     * @summary Updates customer in RDS
     * @param applicationKey
     * @param customerDto The customer body
     * @param customerId The customer ID
     * @param tenantId
     * @param env
     */
    updateCustomer(applicationKey, customerDto, customerId, tenantId, env) {
        const localVarPath = this.basePath + '/customers/{customerId}'
            .replace('{' + 'customerId' + '}', String(customerId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateCustomer.');
        }
        // verify required parameter 'customerDto' is not null or undefined
        if (customerDto === null || customerDto === undefined) {
            throw new Error('Required parameter customerDto was null or undefined when calling updateCustomer.');
        }
        // verify required parameter 'customerId' is not null or undefined
        if (customerId === null || customerId === undefined) {
            throw new Error('Required parameter customerId was null or undefined when calling updateCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: customerDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.CustomercontrollerApi = CustomercontrollerApi;
var TenantinfocontrollerApiApiKeys;
(function (TenantinfocontrollerApiApiKeys) {
})(TenantinfocontrollerApiApiKeys = exports.TenantinfocontrollerApiApiKeys || (exports.TenantinfocontrollerApiApiKeys = {}));
class TenantinfocontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[TenantinfocontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Creates tenant info in RDS, the tenant info contains the configuration of the tenant, RDS will use this configuration to POST a notification after batch retrieve processing completed to notifyUrl and relevant http headers.
     * @summary Creates tenant info in RDS
     * @param tenantInfoDto tenantInfoDto
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    createTenantInfo(tenantInfoDto, applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/tenantInfo';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'tenantInfoDto' is not null or undefined
        if (tenantInfoDto === null || tenantInfoDto === undefined) {
            throw new Error('Required parameter tenantInfoDto was null or undefined when calling createTenantInfo.');
        }
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createTenantInfo.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createTenantInfo.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: tenantInfoDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads the tenant info from RDS, HTTP code 404 will be returned if the tenant has no info in RDS
     * @summary Reads the tenant info from RDS
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    readTenantInfo(applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/tenantInfo';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling readTenantInfo.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling readTenantInfo.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Updates a tenant info by id and TenantInfoDTO
     * @summary Updates tenant info in RDS
     * @param tenantInfoDTO tenantInfoDTO
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    updateTenantInfo(tenantInfoDTO, applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/tenantInfo';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'tenantInfoDTO' is not null or undefined
        if (tenantInfoDTO === null || tenantInfoDTO === undefined) {
            throw new Error('Required parameter tenantInfoDTO was null or undefined when calling updateTenantInfo.');
        }
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateTenantInfo.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateTenantInfo.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: tenantInfoDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.TenantinfocontrollerApi = TenantinfocontrollerApi;
var TransactioncontrollerApiApiKeys;
(function (TransactioncontrollerApiApiKeys) {
})(TransactioncontrollerApiApiKeys = exports.TransactioncontrollerApiApiKeys || (exports.TransactioncontrollerApiApiKeys = {}));
class TransactioncontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[TransactioncontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Adds addtional data to an existing Transaction
     * @summary Adds additional data to Transaction
     * @param applicationKey
     * @param additionalData Map of additional data
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createAdditionalData(applicationKey, additionalData, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/additionalData'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createAdditionalData.');
        }
        // verify required parameter 'additionalData' is not null or undefined
        if (additionalData === null || additionalData === undefined) {
            throw new Error('Required parameter additionalData was null or undefined when calling createAdditionalData.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createAdditionalData.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createAdditionalData.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: additionalData,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of events and add them to an existing Transaction, if the Transaction not exists will return HTTP code 404
     * @summary Creates events for specific transaction
     * @param applicationKey
     * @param events List of events
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createEvents(applicationKey, events, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/events'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createEvents.');
        }
        // verify required parameter 'events' is not null or undefined
        if (events === null || events === undefined) {
            throw new Error('Required parameter events was null or undefined when calling createEvents.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createEvents.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createEvents.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: events,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of pages and add them to an existing Transaction, if the Transaction not exists will return HTTP code 404
     * @summary Creates pages for specific transaction
     * @param applicationKey
     * @param pages List of pages
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createPages(applicationKey, pages, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/pages'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createPages.');
        }
        // verify required parameter 'pages' is not null or undefined
        if (pages === null || pages === undefined) {
            throw new Error('Required parameter pages was null or undefined when calling createPages.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createPages.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createPages.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: pages,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of varibales and add them to an existing Transaction, if the Transaction not exists will return HTTP code 404
     * @summary Creates variables for specific transaction
     * @param applicationKey
     * @param variables List of variables
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createVariables(applicationKey, variables, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/variables'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createVariables.');
        }
        // verify required parameter 'variables' is not null or undefined
        if (variables === null || variables === undefined) {
            throw new Error('Required parameter variables was null or undefined when calling createVariables.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createVariables.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createVariables.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: variables,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets Transaction by id, if not exists HTTP code 404 returned
     * @summary Reads specific Transaction from RDS
     * @param applicationKey
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    getTransaction(applicationKey, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransaction.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling getTransaction.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransaction.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads results from RDS using the batchId returned from 'Offline read of Transactions' (/rds/batch)
     * @summary Gets the batch retrieve results in a zip file
     * @param applicationKey
     * @param batchId Batch D
     * @param tenantId
     * @param env
     */
    getTransactionBatchResult(applicationKey, batchId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/result/{batchId}'
            .replace('{' + 'batchId' + '}', String(batchId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransactionBatchResult.');
        }
        // verify required parameter 'batchId' is not null or undefined
        if (batchId === null || batchId === undefined) {
            throw new Error('Required parameter batchId was null or undefined when calling getTransactionBatchResult.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransactionBatchResult.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads Transactions from RDS by time range, customer id or/and externalSystemId, if all the parameters are empty will read all Transactions. In oth cases the maximum results can be retrieved by this API is 1000, if you need to retrieve more please use the batch retrieve API /rds/batch
     * @summary Reads list of Transaction by criteria
     * @param applicationKey
     * @param tenantId
     * @param timeFrom The start time
     * @param timeTo The end time
     * @param customerId Customer ID
     * @param externalSystemId ExternalSystem ID
     * @param source Transaction source
     * @param categoryId Category ID
     * @param variables Variables list to retrieve, if not passed nothing will be retrieved, if pass the keyword &#39;all&#39;, all varibales will be returned
     * @param env
     */
    getTransactions(applicationKey, tenantId, timeFrom, timeTo, customerId, externalSystemId, source, categoryId, variables, env) {
        const localVarPath = this.basePath + '/transactions';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransactions.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransactions.');
        }
        if (timeFrom !== undefined) {
            queryParameters['timeFrom'] = timeFrom;
        }
        if (timeTo !== undefined) {
            queryParameters['timeTo'] = timeTo;
        }
        if (customerId !== undefined) {
            queryParameters['customerId'] = customerId;
        }
        if (externalSystemId !== undefined) {
            queryParameters['externalSystemId'] = externalSystemId;
        }
        if (source !== undefined) {
            queryParameters['source'] = source;
        }
        if (categoryId !== undefined) {
            queryParameters['categoryId'] = categoryId;
        }
        if (variables !== undefined) {
            queryParameters['variables'] = variables;
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * This API reads Transactions asynchronously, a batchId generated and returned immediatly to the caller as HTTP header, then an async service call to query the Transactions by the time range, customer id or/and externalSystemId executed and stores the results using the batchId generated earlier, this batchId will be used later to get the batch processing results
     * @summary Offline read of Transactions
     * @param applicationKey
     * @param tenantId
     * @param timeFrom The start time
     * @param timeTo The end time
     * @param customerId Customer ID
     * @param externalSystemId ExternalSystem ID
     * @param source Transaction source
     * @param categoryId Category ID
     * @param variables Variables list to retrieve, if not passed nothing will be retrieved, if pass the keyword &#39;all&#39;, all varibales will be returned
     * @param env
     */
    getTransactionsInBatch(applicationKey, tenantId, timeFrom, timeTo, customerId, externalSystemId, source, categoryId, variables, env) {
        const localVarPath = this.basePath + '/transactions/batch';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransactionsInBatch.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransactionsInBatch.');
        }
        if (timeFrom !== undefined) {
            queryParameters['timeFrom'] = timeFrom;
        }
        if (timeTo !== undefined) {
            queryParameters['timeTo'] = timeTo;
        }
        if (customerId !== undefined) {
            queryParameters['customerId'] = customerId;
        }
        if (externalSystemId !== undefined) {
            queryParameters['externalSystemId'] = externalSystemId;
        }
        if (source !== undefined) {
            queryParameters['source'] = source;
        }
        if (categoryId !== undefined) {
            queryParameters['categoryId'] = categoryId;
        }
        if (variables !== undefined) {
            queryParameters['variables'] = variables;
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of TransactionDTOs and loads them into RDS, RDS creates Transaction for each DTO in the list
     * @summary Loads list of transactions to RDS
     * @param applicationKey
     * @param transactions List of transactions
     * @param tenantId
     * @param env
     */
    loadTransactions(applicationKey, transactions, tenantId, env) {
        const localVarPath = this.basePath + '/transactions';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling loadTransactions.');
        }
        // verify required parameter 'transactions' is not null or undefined
        if (transactions === null || transactions === undefined) {
            throw new Error('Required parameter transactions was null or undefined when calling loadTransactions.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling loadTransactions.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: transactions,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Starts a transaction and return an empty TransactionDTO with id to the caller, caller also can send the externalSystemId to be used later to get transactions
     * @summary Starts a transaction in RDS
     * @param applicationKey
     * @param source Transaction source
     * @param tenantId
     * @param externalSystemId External System ID
     * @param env
     */
    startTransaction(applicationKey, source, tenantId, externalSystemId, env) {
        const localVarPath = this.basePath + '/transactions/start';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling startTransaction.');
        }
        // verify required parameter 'source' is not null or undefined
        if (source === null || source === undefined) {
            throw new Error('Required parameter source was null or undefined when calling startTransaction.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling startTransaction.');
        }
        if (externalSystemId !== undefined) {
            queryParameters['externalSystemId'] = externalSystemId;
        }
        if (source !== undefined) {
            queryParameters['source'] = source;
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Updates specific Transaction in RDS using the transaction id and updated TransactionDTO, HTTP code 404 returned if the Transaction not exists
     * @summary Updates specific transaction
     * @param applicationKey
     * @param transactionId Transaction ID
     * @param tenantId
     * @param transactionDto Transaction DTO
     * @param env
     */
    updateTransaction(applicationKey, transactionId, tenantId, transactionDto, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateTransaction.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling updateTransaction.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateTransaction.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: transactionDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.TransactioncontrollerApi = TransactioncontrollerApi;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSmFjYWRhUkRTQXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiSmFjYWRhUkRTQXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7OztHQVVHOztBQUVILG1DQUFvQztBQUdwQyxvQ0FBcUM7QUFFckMsSUFBSSxlQUFlLEdBQUcsMkJBQTJCLENBQUM7QUFFbEQsa0RBQWtEO0FBQ2xELGtEQUFrRDtBQUNsRCxrREFBa0Q7QUFFbEQsdUNBQXVDO0FBRXZDLE1BQWEseUJBQXlCO0NBRXJDO0FBRkQsOERBRUM7QUFFRCxNQUFhLGNBQWM7Q0FRMUI7QUFSRCx3Q0FRQztBQUVELE1BQWEsbUJBQW1CO0NBRy9CO0FBSEQsa0RBR0M7QUFFRCxNQUFhLGFBQWE7Q0FFekI7QUFGRCxzQ0FFQztBQUVELE1BQWEsV0FBVztDQVF2QjtBQVJELGtDQVFDO0FBRUQsTUFBYSxRQUFRO0NBTXBCO0FBTkQsNEJBTUM7QUFFRCxNQUFhLFFBQVE7Q0FLcEI7QUFMRCw0QkFLQztBQUVELE1BQWEsT0FBTztDQU9uQjtBQVBELDBCQU9DO0FBRUQsTUFBYSxjQUFjO0NBRTFCO0FBRkQsd0NBRUM7QUFFRCxNQUFhLGFBQWE7Q0FHekI7QUFIRCxzQ0FHQztBQUVELE1BQWEsY0FBYztDQWUxQjtBQWZELHdDQWVDO0FBRUQsTUFBYSxRQUFRO0NBT3BCO0FBUEQsNEJBT0M7QUFFRCxNQUFhLFdBQVc7Q0FPdkI7QUFQRCxrQ0FPQztBQUVELE1BQWEsYUFBYTtDQUl6QjtBQUpELHNDQUlDO0FBVUQsTUFBYSxhQUFhO0lBR3hCLGNBQWMsQ0FBQyxjQUErQjtRQUM1QyxjQUFjLENBQUMsSUFBSSxHQUFHO1lBQ3BCLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUTtTQUNqRCxDQUFBO0lBQ0gsQ0FBQztDQUNGO0FBUkQsc0NBUUM7QUFFRCxNQUFhLFVBQVU7SUFHckIsWUFBb0IsUUFBZ0IsRUFBVSxTQUFpQjtRQUEz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SUFBSSxFQUFFLEVBQUU7Z0JBQ2hELElBQUksS0FBSyxFQUFFO29CQUNULE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDZjtxQkFBTTtvQkFDTCxJQUFJLFFBQVEsQ0FBQyxVQUFVLElBQUksR0FBRyxJQUFJLFFBQVEsQ0FBQyxVQUFVLElBQUksR0FBRyxFQUFFO3dCQUM1RCxPQUFPLENBQUMsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO3FCQUM3Qzt5QkFBTTt3QkFDTCxNQUFNLENBQUMsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO3FCQUM1QztpQkFDRjtZQUNILENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0NBQ0Y7QUFwNUJELDREQW81QkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFJhdyBEYXRhIFNlcnZpY2UgQVBJXG4gKiBSYXcgZGF0YSBzZXJ2aWNlIChha2EgcmRzKSBBUEkncyBkb2N1bWVudGF0aW9uXG4gKlxuICogT3BlbkFQSSBzcGVjIHZlcnNpb246IDEuMC4wXG4gKlxuICpcbiAqIE5PVEU6IFRoaXMgY2xhc3MgaXMgYXV0byBnZW5lcmF0ZWQgYnkgdGhlIHN3YWdnZXIgY29kZSBnZW5lcmF0b3IgcHJvZ3JhbS5cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9zd2FnZ2VyLWFwaS9zd2FnZ2VyLWNvZGVnZW4uZ2l0XG4gKiBEbyBub3QgZWRpdCB0aGUgY2xhc3MgbWFudWFsbHkuXG4gKi9cblxuaW1wb3J0IHJlcXVlc3QgPSByZXF1aXJlKCdyZXF1ZXN0Jyk7XG4vL2ltcG9ydCBodHRwID0gcmVxdWlyZSgnaHR0cCcpO1xuaW1wb3J0ICogYXMgaHR0cCBmcm9tICdodHRwJztcbmltcG9ydCBQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKTtcblxubGV0IGRlZmF1bHRCYXNlUGF0aCA9ICdodHRwczovL2dvaW50ZXJhY3QuaW8vcmRzJztcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRoaXMgZmlsZSBpcyBhdXRvZ2VuZXJhdGVkIC0gUGxlYXNlIGRvIG5vdCBlZGl0XG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKiB0c2xpbnQ6ZGlzYWJsZTpuby11bnVzZWQtdmFyaWFibGUgKi9cblxuZXhwb3J0IGNsYXNzIEFnZ3JlZ2F0aW9uQ3JlYXRlUmVzcG9uc2Uge1xuICAnYWdncmVnYXRpb25JZCc6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEFnZ3JlZ2F0aW9uRFRPIHtcbiAgJ2NyZWF0aW9uVGltZSc6IG51bWJlcjtcbiAgJ2Rlc2NyaXB0aW9uJzogc3RyaW5nO1xuICAnaWQnOiBzdHJpbmc7XG4gICdtYXBGdW5jdGlvbic6IHN0cmluZztcbiAgJ25hbWUnOiBzdHJpbmc7XG4gICdxdWVyeSc6IHN0cmluZztcbiAgJ3JlZHVjZUZ1bmN0aW9uJzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQWdncmVnYXRpb25SZXNwb25zZSB7XG4gICdpZCc6IHN0cmluZztcbiAgJ3Jlc3VsdCc6IEFycmF5PGFueT47XG59XG5cbmV4cG9ydCBjbGFzcyBCYXRjaFJlc3BvbnNlIHtcbiAgJ2JhdGNoSWQnOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBDdXN0b21lckRUTyB7XG4gICdhZGRpdGlvbmFsRGF0YSc6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nOyB9O1xuICAnYWRkcmVzcyc6IHN0cmluZztcbiAgJ2NvbXBhbnknOiBzdHJpbmc7XG4gICdlbWFpbCc6IHN0cmluZztcbiAgJ2lkJzogc3RyaW5nO1xuICAnbmFtZSc6IHN0cmluZztcbiAgJ3Bob25lJzogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgRXZlbnREVE8ge1xuICAnYWRkaXRpb25hbERhdGEnOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZzsgfTtcbiAgJ2Rlc2NyaXB0aW9uJzogc3RyaW5nO1xuICAncGFnZUlkJzogc3RyaW5nO1xuICAndGltZXN0YW1wJzogbnVtYmVyO1xuICAndHlwZSc6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIEZpZWxkRFRPIHtcbiAgJ2ZpZWxkJzogc3RyaW5nO1xuICAnb3AnOiBzdHJpbmc7XG4gICd0eXBlJzogc3RyaW5nO1xuICAndmFsdWUnOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBQYWdlRFRPIHtcbiAgJ2FkZGl0aW9uYWxEYXRhJzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmc7IH07XG4gICdmdWxsVXJsJzogc3RyaW5nO1xuICAnaWQnOiBzdHJpbmc7XG4gICduYW1lJzogc3RyaW5nO1xuICAndGltZVNwZW50JzogbnVtYmVyO1xuICAndGltZXN0YW1wJzogbnVtYmVyO1xufVxuXG5leHBvcnQgY2xhc3MgUXVlcnlGaWVsZHNEVE8ge1xuICAnZmllbGRzJzogQXJyYXk8RmllbGREVE8+O1xufVxuXG5leHBvcnQgY2xhc3MgVGVuYW50SW5mb0RUTyB7XG4gICdoZWFkZXJzJzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmc7IH07XG4gICdub3RpZnlVcmwnOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBUcmFuc2FjdGlvbkRUTyB7XG4gICdhZGRpdGlvbmFsRGF0YSc6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nOyB9O1xuICAnY2F0ZWdvcnlJZCc6IHN0cmluZztcbiAgJ2N1c3RvbWVySWQnOiBzdHJpbmc7XG4gICdlbmRUaW1lc3RhbXAnOiBudW1iZXI7XG4gICdldmVudHMnOiBBcnJheTxFdmVudERUTz47XG4gICdleHRlcm5hbFN5c3RlbUlkJzogc3RyaW5nO1xuICAnaWQnOiBzdHJpbmc7XG4gICdpcEFkZHJlc3MnOiBzdHJpbmc7XG4gICduYW1lJzogc3RyaW5nO1xuICAncGFnZXMnOiBBcnJheTxQYWdlRFRPPjtcbiAgJ3NvdXJjZSc6IHN0cmluZztcbiAgJ3N0YXJ0VGltZXN0YW1wJzogbnVtYmVyO1xuICAndXNlckFnZW50Jzogc3RyaW5nO1xuICAndmFyaWFibGVzJzogQXJyYXk8VmFyaWFibGVEVE8+O1xufVxuXG5leHBvcnQgY2xhc3MgVmFyaWFibGUge1xuICAnYWRkaXRpb25hbERhdGEnOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZzsgfTtcbiAgJ2RlZmF1bHRWYWx1ZSc6IHN0cmluZztcbiAgJ2lkJzogc3RyaW5nO1xuICAnbGFzdFZhbHVlJzogc3RyaW5nO1xuICAnbmFtZSc6IHN0cmluZztcbiAgJ3ZhbHVlcyc6IEFycmF5PFZhcmlhYmxlVmFsdWU+O1xufVxuXG5leHBvcnQgY2xhc3MgVmFyaWFibGVEVE8ge1xuICAnYWRkaXRpb25hbERhdGEnOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZzsgfTtcbiAgJ2RlZmF1bHRWYWx1ZSc6IHN0cmluZztcbiAgJ2lkJzogc3RyaW5nO1xuICAnbGFzdFZhbHVlJzogc3RyaW5nO1xuICAnbmFtZSc6IHN0cmluZztcbiAgJ3ZhbHVlcyc6IEFycmF5PFZhcmlhYmxlVmFsdWU+O1xufVxuXG5leHBvcnQgY2xhc3MgVmFyaWFibGVWYWx1ZSB7XG4gICdlbGVtZW50Jzogc3RyaW5nO1xuICAndGltZXN0YW1wJzogbnVtYmVyO1xuICAndmFsdWUnOiBzdHJpbmc7XG59XG5cblxuZXhwb3J0IGludGVyZmFjZSBBdXRoZW50aWNhdGlvbiB7XG4gIC8qKlxuICAgKiBBcHBseSBhdXRoZW50aWNhdGlvbiBzZXR0aW5ncyB0byBoZWFkZXIgYW5kIHF1ZXJ5IHBhcmFtcy5cbiAgICovXG4gIGFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgSHR0cEJhc2ljQXV0aCBpbXBsZW1lbnRzIEF1dGhlbnRpY2F0aW9uIHtcbiAgcHVibGljIHVzZXJuYW1lOiBzdHJpbmc7XG4gIHB1YmxpYyBwYXNzd29yZDogc3RyaW5nO1xuICBhcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zKTogdm9pZCB7XG4gICAgcmVxdWVzdE9wdGlvbnMuYXV0aCA9IHtcbiAgICAgIHVzZXJuYW1lOiB0aGlzLnVzZXJuYW1lLCBwYXNzd29yZDogdGhpcy5wYXNzd29yZFxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQXBpS2V5QXV0aCBpbXBsZW1lbnRzIEF1dGhlbnRpY2F0aW9uIHtcbiAgcHVibGljIGFwaUtleTogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbG9jYXRpb246IHN0cmluZywgcHJpdmF0ZSBwYXJhbU5hbWU6IHN0cmluZykge1xuICB9XG5cbiAgYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyk6IHZvaWQge1xuICAgIGlmICh0aGlzLmxvY2F0aW9uID09IFwicXVlcnlcIikge1xuICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMucXMpW3RoaXMucGFyYW1OYW1lXSA9IHRoaXMuYXBpS2V5O1xuICAgIH0gZWxzZSBpZiAodGhpcy5sb2NhdGlvbiA9PSBcImhlYWRlclwiICYmIHJlcXVlc3RPcHRpb25zICYmIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNbdGhpcy5wYXJhbU5hbWVdID0gdGhpcy5hcGlLZXk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBPQXV0aCBpbXBsZW1lbnRzIEF1dGhlbnRpY2F0aW9uIHtcbiAgcHVibGljIGFjY2Vzc1Rva2VuOiBzdHJpbmc7XG5cbiAgYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyk6IHZvaWQge1xuICAgIGlmIChyZXF1ZXN0T3B0aW9ucyAmJiByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICByZXF1ZXN0T3B0aW9ucy5oZWFkZXJzW1wiQXV0aG9yaXphdGlvblwiXSA9IFwiQmVhcmVyIFwiICsgdGhpcy5hY2Nlc3NUb2tlbjtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFZvaWRBdXRoIGltcGxlbWVudHMgQXV0aGVudGljYXRpb24ge1xuICBwdWJsaWMgdXNlcm5hbWU6IHN0cmluZztcbiAgcHVibGljIHBhc3N3b3JkOiBzdHJpbmc7XG4gIGFwcGx5VG9SZXF1ZXN0KF86IHJlcXVlc3QuT3B0aW9ucyk6IHZvaWQge1xuICAgIC8vIERvIG5vdGhpbmdcbiAgfVxufVxuXG5leHBvcnQgZW51bSBBZ2dyZWdhdGlvbmNvbnRyb2xsZXJBcGlBcGlLZXlzIHtcbn1cblxuZXhwb3J0IGNsYXNzIEFnZ3JlZ2F0aW9uY29udHJvbGxlckFwaSB7XG4gIHByb3RlY3RlZCBfYmFzZVBhdGggPSBkZWZhdWx0QmFzZVBhdGg7XG4gIHByb3RlY3RlZCBkZWZhdWx0SGVhZGVycyA6IGFueSA9IHt9O1xuICBwcm90ZWN0ZWQgX3VzZVF1ZXJ5c3RyaW5nIDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHByb3RlY3RlZCBhdXRoZW50aWNhdGlvbnMgPSB7XG4gICAgJ2RlZmF1bHQnOiA8QXV0aGVudGljYXRpb24+bmV3IFZvaWRBdXRoKCksXG4gIH1cblxuICBjb25zdHJ1Y3RvcihiYXNlUGF0aD86IHN0cmluZyk7XG4gIGNvbnN0cnVjdG9yKGJhc2VQYXRoT3JVc2VybmFtZTogc3RyaW5nLCBwYXNzd29yZD86IHN0cmluZywgYmFzZVBhdGg/OiBzdHJpbmcpIHtcbiAgICBpZiAocGFzc3dvcmQpIHtcbiAgICAgIGlmIChiYXNlUGF0aCkge1xuICAgICAgICB0aGlzLmJhc2VQYXRoID0gYmFzZVBhdGg7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChiYXNlUGF0aE9yVXNlcm5hbWUpIHtcbiAgICAgICAgdGhpcy5iYXNlUGF0aCA9IGJhc2VQYXRoT3JVc2VybmFtZVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHNldCB1c2VRdWVyeXN0cmluZyh2YWx1ZTogYm9vbGVhbikge1xuICAgIHRoaXMuX3VzZVF1ZXJ5c3RyaW5nID0gdmFsdWU7XG4gIH1cblxuICBzZXQgYmFzZVBhdGgoYmFzZVBhdGg6IHN0cmluZykge1xuICAgIHRoaXMuX2Jhc2VQYXRoID0gYmFzZVBhdGg7XG4gIH1cblxuICBnZXQgYmFzZVBhdGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2Jhc2VQYXRoO1xuICB9XG5cbiAgcHVibGljIHNldERlZmF1bHRBdXRoZW50aWNhdGlvbihhdXRoOiBBdXRoZW50aWNhdGlvbikge1xuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQgPSBhdXRoO1xuICB9XG5cbiAgcHVibGljIHNldEFwaUtleShrZXk6IEFnZ3JlZ2F0aW9uY29udHJvbGxlckFwaUFwaUtleXMsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9uc1tBZ2dyZWdhdGlvbmNvbnRyb2xsZXJBcGlBcGlLZXlzW2tleV1dLmFwaUtleSA9IHZhbHVlO1xuICB9XG4gIC8qKlxuICAgKiBBZ2dyZWdhdGVzIHJhdyBkYXRhIGJ5IGdpdmVuIHF1ZXJ5LiAgIElmIHRoZSBxdWVyeSBpcyBpbnZhbGlkIEhUVFAgY29kZSA0MDYgaXMgcmV0dXJuZWRcbiAgICogQHN1bW1hcnkgQWdncmVnYXRlcyByYXcgZGF0YVxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXkgUkRTIGFwcGxpY2F0aW9uIGtleVxuICAgKiBAcGFyYW0gYWdncmVnYXRpb25EVE8gQWdncmVnYXRpb25EVE8gaW5jbHVkZXMgdGhlIEFnZ3JlZ2F0aW9uIHF1ZXJ5LiAgIFRoZSBhZ2dyZWdhdGlvbiBxdWVyeSBqc29uIG11c3QgYmUgZXNjYXBlZC4gICBTZWUgaHR0cHM6Ly93d3cuZnJlZWZvcm1hdHRlci5jb20vanNvbi1lc2NhcGUuaHRtbCBmb3Igb25saW5lIGpzb24gZXNjYXBpbmcgIElsbGVnYWwga2V5d29yZHM6ICYjMzk7JHdoZXJlJiMzOTssICYjMzk7JGxvb2t1cCYjMzk7LCAmIzM5OyRvdXQmIzM5OywgJiMzOTskY29sbFN0YXRzJiMzOTssICYjMzk7JGluZGV4U3RhdHMmIzM5OywgJiMzOTtzdGFydFRpbWVzdGFtcCYjMzk7IGFuZCAmIzM5O2VuZFRpbWVzdGFtcCYjMzk7IGluICRtYXRjaCBzdGFnZVxuICAgKiBAcGFyYW0gdGVuYW50SWQgVGVuYW50IElkXG4gICAqIEBwYXJhbSBlbnYgVGVuYW50IGVudmlyb25tZW50IG5hbWUgKEludGVyYWN0IG11bHRpLWVtdmlyb25tZW50KVxuICAgKi9cbiAgcHVibGljIGFnZ3JlZ2F0ZSAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgYWdncmVnYXRpb25EVE86IEFnZ3JlZ2F0aW9uRFRPLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBZ2dyZWdhdGlvbkNyZWF0ZVJlc3BvbnNlOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uJztcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgYWdncmVnYXRlLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FnZ3JlZ2F0aW9uRFRPJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYWdncmVnYXRpb25EVE8gPT09IG51bGwgfHwgYWdncmVnYXRpb25EVE8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25EVE8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGUuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGFnZ3JlZ2F0ZS4nKTtcbiAgICB9XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xuXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XG5cbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IGFnZ3JlZ2F0aW9uRFRPLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBZ2dyZWdhdGlvbkNyZWF0ZVJlc3BvbnNlOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFJldHVybnMgYWdncmVnYXRlZCBkYXRhIGJ5IGdpdmVuIHF1ZXJ5LiAgIElmIHRoZSBxdWVyeSBpcyBpbnZhbGlkIEhUVFAgY29kZSA0MDYgaXMgcmV0dXJuZWRcbiAgICogQHN1bW1hcnkgUmV0cmlldmVzIGFnZ3JlZ2F0ZWQgZGF0YVxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXkgUkRTIGFwcGxpY2F0aW9uIGtleVxuICAgKiBAcGFyYW0gcXVlcnkgQWdncmVnYXRpb24gcXVlcnkuICBUaGUgYWdncmVnYXRpb24gcXVlcnkganNvbiBtdXN0IGJlIGVzY2FwZWQuICAgU2VlIGh0dHBzOi8vd3d3LmZyZWVmb3JtYXR0ZXIuY29tL2pzb24tZXNjYXBlLmh0bWwgZm9yIG9ubGluZSBqc29uIGVzY2FwaW5nICBJbGxlZ2FsIGtleXdvcmRzOiAmIzM5OyR3aGVyZSYjMzk7LCAmIzM5OyRsb29rdXAmIzM5OywgJiMzOTskb3V0JiMzOTssICYjMzk7JGNvbGxTdGF0cyYjMzk7LCAmIzM5OyRpbmRleFN0YXRzJiMzOTtcbiAgICogQHBhcmFtIGFnZ3JlZ2F0aW9uSWQgQWdncmVnYXRpb24gZGVmaW5pdGlvbiBpZFxuICAgKiBAcGFyYW0gdGVuYW50SWQgVGVuYW50IElkXG4gICAqIEBwYXJhbSBlbnYgVGVuYW50IGVudmlyb25tZW50IG5hbWUgKEludGVyYWN0IG11bHRpLWVtdmlyb25tZW50KVxuICAgKi9cbiAgcHVibGljIGFnZ3JlZ2F0aW9uUmV0cmlldmUgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHF1ZXJ5OiBNb2RlbFN0cmluZywgYWdncmVnYXRpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBcnJheTxhbnk+OyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uL3Jlc3VsdHMve2FnZ3JlZ2F0aW9uSWR9J1xuICAgICAgLnJlcGxhY2UoJ3snICsgJ2FnZ3JlZ2F0aW9uSWQnICsgJ30nLCBTdHJpbmcoYWdncmVnYXRpb25JZCkpO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGlvblJldHJpZXZlLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3F1ZXJ5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAocXVlcnkgPT09IG51bGwgfHwgcXVlcnkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgcXVlcnkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGlvblJldHJpZXZlLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FnZ3JlZ2F0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhZ2dyZWdhdGlvbklkID09PSBudWxsIHx8IGFnZ3JlZ2F0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGFnZ3JlZ2F0aW9uUmV0cmlldmUuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGFnZ3JlZ2F0aW9uUmV0cmlldmUuJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiBxdWVyeSxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQXJyYXk8YW55PjsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBGb3IgdGVzdGluZyB0aGUgYWdncmVnYXRpb24gcXVlcnkgYmVmb3JlIGNhbGxpbmcgdGhlIGFnZ3JlZ2F0ZSBBUEkuICBXaWxsIHJ1biB0aGUgcXVlcnkgb24gdGhlIHBhc3QgNCBob3VycyBhbmQgd2lsbCByZXR1cm4gdGhlIHJlc3VsdHMgb2YgdGhlIGFnZ3JlZ2F0aW9uLiAgSWYgdGhlIHF1ZXJ5IGlzIGludmFsaWQgSFRUUCBjb2RlIDQwNiBpcyByZXR1cm5lZFxuICAgKiBAc3VtbWFyeSBUZXN0cyBhZ2dyZWdhdGlvbiBxdWVyeSBvZiByYXcgZGF0YVxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXkgUkRTIGFwcGxpY2F0aW9uIGtleVxuICAgKiBAcGFyYW0gcXVlcnkgQWdncmVnYXRpb24gdGVzdCBxdWVyeS4gIFRoZSBhZ2dyZWdhdGlvbiBxdWVyeSBqc29uIG11c3QgYmUgZXNjYXBlZC4gICBTZWUgaHR0cHM6Ly93d3cuZnJlZWZvcm1hdHRlci5jb20vanNvbi1lc2NhcGUuaHRtbCBmb3Igb25saW5lIGpzb24gZXNjYXBpbmcgIElsbGVnYWwga2V5d29yZHM6ICYjMzk7JHdoZXJlJiMzOTssICYjMzk7JGxvb2t1cCYjMzk7LCAmIzM5OyRvdXQmIzM5OywgJiMzOTskY29sbFN0YXRzJiMzOTssICYjMzk7JGluZGV4U3RhdHMmIzM5OywgJiMzOTtzdGFydFRpbWVzdGFtcCYjMzk7IGFuZCAmIzM5O2VuZFRpbWVzdGFtcCYjMzk7IGluICRtYXRjaCBzdGFnZVxuICAgKiBAcGFyYW0gdGVuYW50SWQgVGVuYW50IElkXG4gICAqIEBwYXJhbSBlbnYgVGVuYW50IGVudmlyb25tZW50IG5hbWUgKEludGVyYWN0IG11bHRpLWVtdmlyb25tZW50KVxuICAgKi9cbiAgcHVibGljIGFnZ3JlZ2F0aW9uVGVzdCAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgcXVlcnk6IE1vZGVsU3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBZ2dyZWdhdGlvblJlc3BvbnNlOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uL3Rlc3QnO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGlvblRlc3QuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAncXVlcnknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChxdWVyeSA9PT0gbnVsbCB8fCBxdWVyeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBxdWVyeSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGFnZ3JlZ2F0aW9uVGVzdC4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgYWdncmVnYXRpb25UZXN0LicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgYm9keTogcXVlcnksXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFnZ3JlZ2F0aW9uUmVzcG9uc2U7ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogRGVsZXRlcyBhZ2dyZWdhdGlvbiBieSBpZCwgaWYgdGhlIHRoZSBhZ2dyZWdhdGlvbiBub3QgZXhpc3RzIEhUVFAgY29kZSA0MDQgcmV0dXJuZWRcbiAgICogQHN1bW1hcnkgRGVsZXRlcyBhIHNwZWNpZmljIGFnZ3JlZ2F0aW9uIGluIFJEU1xuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIGFnZ3JlZ2F0aW9uSWQgVGhlIGFnZ3JlZ2F0aW9uIElEXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxuICAgKiBAcGFyYW0gZW52XG4gICAqL1xuICBwdWJsaWMgZGVsZXRlQWdncmVnYXRpb24gKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIGFnZ3JlZ2F0aW9uSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogc3RyaW5nOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uL3thZ2dyZWdhdGlvbklkfSdcbiAgICAgIC5yZXBsYWNlKCd7JyArICdhZ2dyZWdhdGlvbklkJyArICd9JywgU3RyaW5nKGFnZ3JlZ2F0aW9uSWQpKTtcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZGVsZXRlQWdncmVnYXRpb24uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYWdncmVnYXRpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFnZ3JlZ2F0aW9uSWQgPT09IG51bGwgfHwgYWdncmVnYXRpb25JZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhZ2dyZWdhdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZGVsZXRlQWdncmVnYXRpb24uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGRlbGV0ZUFnZ3JlZ2F0aW9uLicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IHN0cmluZzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBSZXR1cm5zIGFnZ3JlZ2F0ZWQgZGF0YSBieSBnaXZlbiBxdWVyeS5cbiAgICogQHN1bW1hcnkgUmV0cmlldmVzIGFnZ3JlZ2F0ZWQgZGF0YSBieSBmaW5kIHF1ZXJ5XG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleSBSRFMgYXBwbGljYXRpb24ga2V5XG4gICAqIEBwYXJhbSBxdWVyeUZpZWxkc0RUTyBGaWVsZHMgdG8gdXNlIGluIHRoZSBmaW5kIHF1ZXJ5LlxuICAgKiBAcGFyYW0gYWdncmVnYXRpb25JZCBBZ2dyZWdhdGlvbiBkZWZpbml0aW9uIGlkXG4gICAqIEBwYXJhbSB0ZW5hbnRJZCBUZW5hbnQgSWRcbiAgICogQHBhcmFtIGVudiBUZW5hbnQgZW52aXJvbm1lbnQgbmFtZSAoSW50ZXJhY3QgbXVsdGktZW12aXJvbm1lbnQpXG4gICAqL1xuICBwdWJsaWMgZmluZFF1ZXJ5UmV0cmlldmUgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHF1ZXJ5RmllbGRzRFRPOiBRdWVyeUZpZWxkc0RUTywgYWdncmVnYXRpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBcnJheTxhbnk+OyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uL3Jlc3VsdHMvc2ltcGxlL3thZ2dyZWdhdGlvbklkfSdcbiAgICAgIC5yZXBsYWNlKCd7JyArICdhZ2dyZWdhdGlvbklkJyArICd9JywgU3RyaW5nKGFnZ3JlZ2F0aW9uSWQpKTtcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZmluZFF1ZXJ5UmV0cmlldmUuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAncXVlcnlGaWVsZHNEVE8nIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChxdWVyeUZpZWxkc0RUTyA9PT0gbnVsbCB8fCBxdWVyeUZpZWxkc0RUTyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBxdWVyeUZpZWxkc0RUTyB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGZpbmRRdWVyeVJldHJpZXZlLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FnZ3JlZ2F0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhZ2dyZWdhdGlvbklkID09PSBudWxsIHx8IGFnZ3JlZ2F0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGZpbmRRdWVyeVJldHJpZXZlLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBmaW5kUXVlcnlSZXRyaWV2ZS4nKTtcbiAgICB9XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xuXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XG5cbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IHF1ZXJ5RmllbGRzRFRPLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBcnJheTxhbnk+OyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEdldCBsaXN0IG9mIGFnZ3JlZ2F0aW9ucyBjcmVhdGVkIGZvciB0ZW5hbnRcbiAgICogQHN1bW1hcnkgR2V0cyBsaXN0IG9mIGFnZ3JlZ2F0aW9uc1xuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIHRlbmFudElkXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyBnZXRBZ2dyZWdhdGlvbnMgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFycmF5PEFnZ3JlZ2F0aW9uRFRPPjsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hZ2dyZWdhdGlvbic7XG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcblxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldEFnZ3JlZ2F0aW9ucy4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0QWdncmVnYXRpb25zLicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFycmF5PEFnZ3JlZ2F0aW9uRFRPPjsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBVcGRhdGVzIGFnZ3JlZ2F0aW9uIGJ5IGlkLCBpZiB0aGUgdGhlIGFnZ3JlZ2F0aW9uIG5vdCBleGlzdHMgSFRUUCBjb2RlIDQwNCByZXR1cm5lZFxuICAgKiBAc3VtbWFyeSBVcGRhdGVzIGEgc3BlY2lmaWMgYWdncmVnYXRpb24gaW4gUkRTXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxuICAgKiBAcGFyYW0gYWdncmVnYXRpb25JZCBUaGUgYWdncmVnYXRpb24gSURcbiAgICogQHBhcmFtIGFnZ3JlZ2F0aW9uRFRPIEFnZ3JlZ2F0aW9uRFRPIGluY2x1ZGVzIHRoZSBBZ2dyZWdhdGlvbiBxdWVyeS4gICBUaGUgYWdncmVnYXRpb24gcXVlcnkganNvbiBtdXN0IGJlIGVzY2FwZWQuICAgU2VlIGh0dHBzOi8vd3d3LmZyZWVmb3JtYXR0ZXIuY29tL2pzb24tZXNjYXBlLmh0bWwgZm9yIG9ubGluZSBqc29uIGVzY2FwaW5nICBJbGxlZ2FsIGtleXdvcmRzOiAmIzM5OyR3aGVyZSYjMzk7LCAmIzM5OyRsb29rdXAmIzM5OywgJiMzOTskb3V0JiMzOTssICYjMzk7JGNvbGxTdGF0cyYjMzk7LCAmIzM5OyRpbmRleFN0YXRzJiMzOTssICYjMzk7c3RhcnRUaW1lc3RhbXAmIzM5OyBhbmQgJiMzOTtlbmRUaW1lc3RhbXAmIzM5OyBpbiAkbWF0Y2ggc3RhZ2VcbiAgICogQHBhcmFtIHRlbmFudElkXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyB1cGRhdGVBZ2dyZWdhdGlvbiAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgYWdncmVnYXRpb25JZDogc3RyaW5nLCBhZ2dyZWdhdGlvbkRUTzogQWdncmVnYXRpb25EVE8sIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IHN0cmluZzsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hZ2dyZWdhdGlvbi97YWdncmVnYXRpb25JZH0nXG4gICAgICAucmVwbGFjZSgneycgKyAnYWdncmVnYXRpb25JZCcgKyAnfScsIFN0cmluZyhhZ2dyZWdhdGlvbklkKSk7XG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcblxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZUFnZ3JlZ2F0aW9uLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FnZ3JlZ2F0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhZ2dyZWdhdGlvbklkID09PSBudWxsIHx8IGFnZ3JlZ2F0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZUFnZ3JlZ2F0aW9uLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FnZ3JlZ2F0aW9uRFRPJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYWdncmVnYXRpb25EVE8gPT09IG51bGwgfHwgYWdncmVnYXRpb25EVE8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25EVE8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVBZ2dyZWdhdGlvbi4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlQWdncmVnYXRpb24uJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IGFnZ3JlZ2F0aW9uRFRPLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBzdHJpbmc7ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuZXhwb3J0IGVudW0gQ3VzdG9tZXJjb250cm9sbGVyQXBpQXBpS2V5cyB7XG59XG5cbmV4cG9ydCBjbGFzcyBDdXN0b21lcmNvbnRyb2xsZXJBcGkge1xuICBwcm90ZWN0ZWQgX2Jhc2VQYXRoID0gZGVmYXVsdEJhc2VQYXRoO1xuICBwcm90ZWN0ZWQgZGVmYXVsdEhlYWRlcnMgOiBhbnkgPSB7fTtcbiAgcHJvdGVjdGVkIF91c2VRdWVyeXN0cmluZyA6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcm90ZWN0ZWQgYXV0aGVudGljYXRpb25zID0ge1xuICAgICdkZWZhdWx0JzogPEF1dGhlbnRpY2F0aW9uPm5ldyBWb2lkQXV0aCgpLFxuICB9XG5cbiAgY29uc3RydWN0b3IoYmFzZVBhdGg/OiBzdHJpbmcpO1xuICBjb25zdHJ1Y3RvcihiYXNlUGF0aE9yVXNlcm5hbWU6IHN0cmluZywgcGFzc3dvcmQ/OiBzdHJpbmcsIGJhc2VQYXRoPzogc3RyaW5nKSB7XG4gICAgaWYgKHBhc3N3b3JkKSB7XG4gICAgICBpZiAoYmFzZVBhdGgpIHtcbiAgICAgICAgdGhpcy5iYXNlUGF0aCA9IGJhc2VQYXRoO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYmFzZVBhdGhPclVzZXJuYW1lKSB7XG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aE9yVXNlcm5hbWVcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXQgdXNlUXVlcnlzdHJpbmcodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl91c2VRdWVyeXN0cmluZyA9IHZhbHVlO1xuICB9XG5cbiAgc2V0IGJhc2VQYXRoKGJhc2VQYXRoOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9iYXNlUGF0aCA9IGJhc2VQYXRoO1xuICB9XG5cbiAgZ2V0IGJhc2VQYXRoKCkge1xuICAgIHJldHVybiB0aGlzLl9iYXNlUGF0aDtcbiAgfVxuXG4gIHB1YmxpYyBzZXREZWZhdWx0QXV0aGVudGljYXRpb24oYXV0aDogQXV0aGVudGljYXRpb24pIHtcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0ID0gYXV0aDtcbiAgfVxuXG4gIHB1YmxpYyBzZXRBcGlLZXkoa2V5OiBDdXN0b21lcmNvbnRyb2xsZXJBcGlBcGlLZXlzLCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnNbQ3VzdG9tZXJjb250cm9sbGVyQXBpQXBpS2V5c1trZXldXS5hcGlLZXkgPSB2YWx1ZTtcbiAgfVxuICAvKipcbiAgICogQ3JlYXRlcyB0aGUgY3VzdG9tZXIgaW4gUkRTIGZyb20gdGhlIEN1c3RvbWVyRFRPIGluIHRoZSBib2R5IGFuZCByZXR1cm4gSFRUUCBjb2RlIDIwMSAoY3JlYXRlZClcbiAgICogQHN1bW1hcnkgQ3JlYXRlcyBjdXN0b21lciBpbiBSRFNcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XG4gICAqIEBwYXJhbSBjdXN0b21lckR0byBUaGUgY3VzdG9tZXIgYm9keVxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGVudlxuICAgKi9cbiAgcHVibGljIGNyZWF0ZUN1c3RvbWVyIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBjdXN0b21lckR0bzogQ3VzdG9tZXJEVE8sIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEN1c3RvbWVyRFRPOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2N1c3RvbWVycyc7XG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcblxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZUN1c3RvbWVyLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2N1c3RvbWVyRHRvJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoY3VzdG9tZXJEdG8gPT09IG51bGwgfHwgY3VzdG9tZXJEdG8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgY3VzdG9tZXJEdG8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVDdXN0b21lci4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlQ3VzdG9tZXIuJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiBjdXN0b21lckR0byxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQ3VzdG9tZXJEVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogRGVsZXRlcyBjdXN0b21lciBieSBpZCwgaWYgdGhlIHRoZSBjdXN0b21lciBub3QgZXhpc3RzIEhUVFAgY29kZSA0MDQgcmV0dXJuZWRcbiAgICogQHN1bW1hcnkgRGVsZXRlcyBhIGN1c3RvbWVyIGluIFJEU1xuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIGN1c3RvbWVySWQgVGhlIGN1c3RvbWVyIElEXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxuICAgKiBAcGFyYW0gZW52XG4gICAqL1xuICBwdWJsaWMgZGVsZXRlQ3VzdG9tZXIgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIGN1c3RvbWVySWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogc3RyaW5nOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2N1c3RvbWVycy97Y3VzdG9tZXJJZH0nXG4gICAgICAucmVwbGFjZSgneycgKyAnY3VzdG9tZXJJZCcgKyAnfScsIFN0cmluZyhjdXN0b21lcklkKSk7XG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcblxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGRlbGV0ZUN1c3RvbWVyLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2N1c3RvbWVySWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChjdXN0b21lcklkID09PSBudWxsIHx8IGN1c3RvbWVySWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgY3VzdG9tZXJJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGRlbGV0ZUN1c3RvbWVyLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBkZWxldGVDdXN0b21lci4nKTtcbiAgICB9XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xuXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XG5cbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXG4gICAgICBqc29uOiB0cnVlLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBzdHJpbmc7ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogUmVhZHMgdGhlIGN1c3RvbWVyIGZyb20gUkRTIGJ5IGN1c3RvbWVyIGlkLCBpZiB0aGUgY3VzdG9tZXIgbm90IGV4aXN0cyBpbiBSRFMsIEhUVFAgZXJyb3IgNDA0IHJldHVybmVkXG4gICAqIEBzdW1tYXJ5IEdldHMgc3BlY2lmaWMgY3VzdG9tZXIgZnJvbSBSRFMgYnkgY3VzdG9tZXIgaWRcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XG4gICAqIEBwYXJhbSBjdXN0b21lcklkIFRoZSBjdXN0b21lciBJRFxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGVudlxuICAgKi9cbiAgcHVibGljIHJlYWRDdXN0b21lciAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgY3VzdG9tZXJJZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBDdXN0b21lckRUTzsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9jdXN0b21lcnMve2N1c3RvbWVySWR9J1xuICAgICAgLnJlcGxhY2UoJ3snICsgJ2N1c3RvbWVySWQnICsgJ30nLCBTdHJpbmcoY3VzdG9tZXJJZCkpO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyByZWFkQ3VzdG9tZXIuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnY3VzdG9tZXJJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGN1c3RvbWVySWQgPT09IG51bGwgfHwgY3VzdG9tZXJJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBjdXN0b21lcklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgcmVhZEN1c3RvbWVyLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyByZWFkQ3VzdG9tZXIuJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQ3VzdG9tZXJEVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogVXNpbmcgY3VzdG9tZXIgaWQgYW5kIEN1c3RvbWVyRFRPIHdpbGwgdXBkYXRlIHRoZSBzcGNpZmljIGN1c3RvbWVyIGFuZCByZXR1cm4gSFRUUCBjb2RlIDIwMCBpZiBzdWNjZXNzIG9yIGlmIHRoZSBjdXN0b21lciBub3QgZm91bmQgSFRUUCBjb2RlIDQwNFxuICAgKiBAc3VtbWFyeSBVcGRhdGVzIGN1c3RvbWVyIGluIFJEU1xuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIGN1c3RvbWVyRHRvIFRoZSBjdXN0b21lciBib2R5XG4gICAqIEBwYXJhbSBjdXN0b21lcklkIFRoZSBjdXN0b21lciBJRFxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGVudlxuICAgKi9cbiAgcHVibGljIHVwZGF0ZUN1c3RvbWVyIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBjdXN0b21lckR0bzogc3RyaW5nLCBjdXN0b21lcklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEN1c3RvbWVyRFRPOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2N1c3RvbWVycy97Y3VzdG9tZXJJZH0nXG4gICAgICAucmVwbGFjZSgneycgKyAnY3VzdG9tZXJJZCcgKyAnfScsIFN0cmluZyhjdXN0b21lcklkKSk7XG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcblxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZUN1c3RvbWVyLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2N1c3RvbWVyRHRvJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoY3VzdG9tZXJEdG8gPT09IG51bGwgfHwgY3VzdG9tZXJEdG8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgY3VzdG9tZXJEdG8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVDdXN0b21lci4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdjdXN0b21lcklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoY3VzdG9tZXJJZCA9PT0gbnVsbCB8fCBjdXN0b21lcklkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGN1c3RvbWVySWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVDdXN0b21lci4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlQ3VzdG9tZXIuJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IGN1c3RvbWVyRHRvLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBDdXN0b21lckRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5leHBvcnQgZW51bSBUZW5hbnRpbmZvY29udHJvbGxlckFwaUFwaUtleXMge1xufVxuXG5leHBvcnQgY2xhc3MgVGVuYW50aW5mb2NvbnRyb2xsZXJBcGkge1xuICBwcm90ZWN0ZWQgX2Jhc2VQYXRoID0gZGVmYXVsdEJhc2VQYXRoO1xuICBwcm90ZWN0ZWQgZGVmYXVsdEhlYWRlcnMgOiBhbnkgPSB7fTtcbiAgcHJvdGVjdGVkIF91c2VRdWVyeXN0cmluZyA6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcm90ZWN0ZWQgYXV0aGVudGljYXRpb25zID0ge1xuICAgICdkZWZhdWx0JzogPEF1dGhlbnRpY2F0aW9uPm5ldyBWb2lkQXV0aCgpLFxuICB9XG5cbiAgY29uc3RydWN0b3IoYmFzZVBhdGg/OiBzdHJpbmcpO1xuICBjb25zdHJ1Y3RvcihiYXNlUGF0aE9yVXNlcm5hbWU6IHN0cmluZywgcGFzc3dvcmQ/OiBzdHJpbmcsIGJhc2VQYXRoPzogc3RyaW5nKSB7XG4gICAgaWYgKHBhc3N3b3JkKSB7XG4gICAgICBpZiAoYmFzZVBhdGgpIHtcbiAgICAgICAgdGhpcy5iYXNlUGF0aCA9IGJhc2VQYXRoO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYmFzZVBhdGhPclVzZXJuYW1lKSB7XG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aE9yVXNlcm5hbWVcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXQgdXNlUXVlcnlzdHJpbmcodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl91c2VRdWVyeXN0cmluZyA9IHZhbHVlO1xuICB9XG5cbiAgc2V0IGJhc2VQYXRoKGJhc2VQYXRoOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9iYXNlUGF0aCA9IGJhc2VQYXRoO1xuICB9XG5cbiAgZ2V0IGJhc2VQYXRoKCkge1xuICAgIHJldHVybiB0aGlzLl9iYXNlUGF0aDtcbiAgfVxuXG4gIHB1YmxpYyBzZXREZWZhdWx0QXV0aGVudGljYXRpb24oYXV0aDogQXV0aGVudGljYXRpb24pIHtcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0ID0gYXV0aDtcbiAgfVxuXG4gIHB1YmxpYyBzZXRBcGlLZXkoa2V5OiBUZW5hbnRpbmZvY29udHJvbGxlckFwaUFwaUtleXMsIHZhbHVlOiBzdHJpbmcpIHtcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9uc1tUZW5hbnRpbmZvY29udHJvbGxlckFwaUFwaUtleXNba2V5XV0uYXBpS2V5ID0gdmFsdWU7XG4gIH1cbiAgLyoqXG4gICAqIENyZWF0ZXMgdGVuYW50IGluZm8gaW4gUkRTLCB0aGUgdGVuYW50IGluZm8gY29udGFpbnMgdGhlIGNvbmZpZ3VyYXRpb24gb2YgdGhlIHRlbmFudCwgUkRTIHdpbGwgdXNlIHRoaXMgY29uZmlndXJhdGlvbiB0byBQT1NUIGEgbm90aWZpY2F0aW9uIGFmdGVyIGJhdGNoIHJldHJpZXZlIHByb2Nlc3NpbmcgY29tcGxldGVkIHRvIG5vdGlmeVVybCBhbmQgcmVsZXZhbnQgaHR0cCBoZWFkZXJzLlxuICAgKiBAc3VtbWFyeSBDcmVhdGVzIHRlbmFudCBpbmZvIGluIFJEU1xuICAgKiBAcGFyYW0gdGVuYW50SW5mb0R0byB0ZW5hbnRJbmZvRHRvXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGVudlxuICAgKi9cbiAgcHVibGljIGNyZWF0ZVRlbmFudEluZm8gKHRlbmFudEluZm9EdG86IFRlbmFudEluZm9EVE8sIGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRlbmFudEluZm9EVE87ICB9PiB7XG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdGVuYW50SW5mbyc7XG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcblxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SW5mb0R0bycgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudEluZm9EdG8gPT09IG51bGwgfHwgdGVuYW50SW5mb0R0byA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJbmZvRHRvIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVGVuYW50SW5mby4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVGVuYW50SW5mby4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVGVuYW50SW5mby4nKTtcbiAgICB9XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xuXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XG5cbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IHRlbmFudEluZm9EdG8sXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRlbmFudEluZm9EVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogUmVhZHMgdGhlIHRlbmFudCBpbmZvIGZyb20gUkRTLCBIVFRQIGNvZGUgNDA0IHdpbGwgYmUgcmV0dXJuZWQgaWYgdGhlIHRlbmFudCBoYXMgbm8gaW5mbyBpbiBSRFNcbiAgICogQHN1bW1hcnkgUmVhZHMgdGhlIHRlbmFudCBpbmZvIGZyb20gUkRTXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGVudlxuICAgKi9cbiAgcHVibGljIHJlYWRUZW5hbnRJbmZvIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUZW5hbnRJbmZvRFRPOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RlbmFudEluZm8nO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyByZWFkVGVuYW50SW5mby4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgcmVhZFRlbmFudEluZm8uJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVGVuYW50SW5mb0RUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBVcGRhdGVzIGEgdGVuYW50IGluZm8gYnkgaWQgYW5kIFRlbmFudEluZm9EVE9cbiAgICogQHN1bW1hcnkgVXBkYXRlcyB0ZW5hbnQgaW5mbyBpbiBSRFNcbiAgICogQHBhcmFtIHRlbmFudEluZm9EVE8gdGVuYW50SW5mb0RUT1xuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIHRlbmFudElkXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyB1cGRhdGVUZW5hbnRJbmZvICh0ZW5hbnRJbmZvRFRPOiBUZW5hbnRJbmZvRFRPLCBhcHBsaWNhdGlvbktleTogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUZW5hbnRJbmZvRFRPOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RlbmFudEluZm8nO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudEluZm9EVE8nIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJbmZvRFRPID09PSBudWxsIHx8IHRlbmFudEluZm9EVE8gPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SW5mb0RUTyB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZVRlbmFudEluZm8uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZVRlbmFudEluZm8uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZVRlbmFudEluZm8uJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IHRlbmFudEluZm9EVE8sXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRlbmFudEluZm9EVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuZXhwb3J0IGVudW0gVHJhbnNhY3Rpb25jb250cm9sbGVyQXBpQXBpS2V5cyB7XG59XG5cbmV4cG9ydCBjbGFzcyBUcmFuc2FjdGlvbmNvbnRyb2xsZXJBcGkge1xuICBwcm90ZWN0ZWQgX2Jhc2VQYXRoID0gZGVmYXVsdEJhc2VQYXRoO1xuICBwcm90ZWN0ZWQgZGVmYXVsdEhlYWRlcnMgOiBhbnkgPSB7fTtcbiAgcHJvdGVjdGVkIF91c2VRdWVyeXN0cmluZyA6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBwcm90ZWN0ZWQgYXV0aGVudGljYXRpb25zID0ge1xuICAgICdkZWZhdWx0JzogPEF1dGhlbnRpY2F0aW9uPm5ldyBWb2lkQXV0aCgpLFxuICB9XG5cbiAgY29uc3RydWN0b3IoYmFzZVBhdGg/OiBzdHJpbmcpO1xuICBjb25zdHJ1Y3RvcihiYXNlUGF0aE9yVXNlcm5hbWU6IHN0cmluZywgcGFzc3dvcmQ/OiBzdHJpbmcsIGJhc2VQYXRoPzogc3RyaW5nKSB7XG4gICAgaWYgKHBhc3N3b3JkKSB7XG4gICAgICBpZiAoYmFzZVBhdGgpIHtcbiAgICAgICAgdGhpcy5iYXNlUGF0aCA9IGJhc2VQYXRoO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYmFzZVBhdGhPclVzZXJuYW1lKSB7XG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aE9yVXNlcm5hbWVcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXQgdXNlUXVlcnlzdHJpbmcodmFsdWU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLl91c2VRdWVyeXN0cmluZyA9IHZhbHVlO1xuICB9XG5cbiAgc2V0IGJhc2VQYXRoKGJhc2VQYXRoOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9iYXNlUGF0aCA9IGJhc2VQYXRoO1xuICB9XG5cbiAgZ2V0IGJhc2VQYXRoKCkge1xuICAgIHJldHVybiB0aGlzLl9iYXNlUGF0aDtcbiAgfVxuXG4gIHB1YmxpYyBzZXREZWZhdWx0QXV0aGVudGljYXRpb24oYXV0aDogQXV0aGVudGljYXRpb24pIHtcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0ID0gYXV0aDtcbiAgfVxuXG4gIHB1YmxpYyBzZXRBcGlLZXkoa2V5OiBUcmFuc2FjdGlvbmNvbnRyb2xsZXJBcGlBcGlLZXlzLCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnNbVHJhbnNhY3Rpb25jb250cm9sbGVyQXBpQXBpS2V5c1trZXldXS5hcGlLZXkgPSB2YWx1ZTtcbiAgfVxuICAvKipcbiAgICogQWRkcyBhZGR0aW9uYWwgZGF0YSB0byBhbiBleGlzdGluZyBUcmFuc2FjdGlvblxuICAgKiBAc3VtbWFyeSBBZGRzIGFkZGl0aW9uYWwgZGF0YSB0byBUcmFuc2FjdGlvblxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIGFkZGl0aW9uYWxEYXRhIE1hcCBvZiBhZGRpdGlvbmFsIGRhdGFcbiAgICogQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSURcbiAgICogQHBhcmFtIHRlbmFudElkXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyBjcmVhdGVBZGRpdGlvbmFsRGF0YSAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgYWRkaXRpb25hbERhdGE6IGFueSwgdHJhbnNhY3Rpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMve3RyYW5zYWN0aW9uSWR9L2FkZGl0aW9uYWxEYXRhJ1xuICAgICAgLnJlcGxhY2UoJ3snICsgJ3RyYW5zYWN0aW9uSWQnICsgJ30nLCBTdHJpbmcodHJhbnNhY3Rpb25JZCkpO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVBZGRpdGlvbmFsRGF0YS4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhZGRpdGlvbmFsRGF0YScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFkZGl0aW9uYWxEYXRhID09PSBudWxsIHx8IGFkZGl0aW9uYWxEYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFkZGl0aW9uYWxEYXRhIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlQWRkaXRpb25hbERhdGEuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndHJhbnNhY3Rpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgdHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlQWRkaXRpb25hbERhdGEuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZUFkZGl0aW9uYWxEYXRhLicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgYm9keTogYWRkaXRpb25hbERhdGEsXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEdldHMgYSBsaXN0IG9mIGV2ZW50cyBhbmQgYWRkIHRoZW0gdG8gYW4gZXhpc3RpbmcgVHJhbnNhY3Rpb24sIGlmIHRoZSBUcmFuc2FjdGlvbiBub3QgZXhpc3RzIHdpbGwgcmV0dXJuIEhUVFAgY29kZSA0MDRcbiAgICogQHN1bW1hcnkgQ3JlYXRlcyBldmVudHMgZm9yIHNwZWNpZmljIHRyYW5zYWN0aW9uXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxuICAgKiBAcGFyYW0gZXZlbnRzIExpc3Qgb2YgZXZlbnRzXG4gICAqIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElEXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxuICAgKiBAcGFyYW0gZW52XG4gICAqL1xuICBwdWJsaWMgY3JlYXRlRXZlbnRzIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBldmVudHM6IEV2ZW50RFRPLCB0cmFuc2FjdGlvbklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RyYW5zYWN0aW9ucy97dHJhbnNhY3Rpb25JZH0vZXZlbnRzJ1xuICAgICAgLnJlcGxhY2UoJ3snICsgJ3RyYW5zYWN0aW9uSWQnICsgJ30nLCBTdHJpbmcodHJhbnNhY3Rpb25JZCkpO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVFdmVudHMuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnZXZlbnRzJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoZXZlbnRzID09PSBudWxsIHx8IGV2ZW50cyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBldmVudHMgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVFdmVudHMuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndHJhbnNhY3Rpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgdHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlRXZlbnRzLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVFdmVudHMuJyk7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiBldmVudHMsXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIEdldHMgYSBsaXN0IG9mIHBhZ2VzIGFuZCBhZGQgdGhlbSB0byBhbiBleGlzdGluZyBUcmFuc2FjdGlvbiwgaWYgdGhlIFRyYW5zYWN0aW9uIG5vdCBleGlzdHMgd2lsbCByZXR1cm4gSFRUUCBjb2RlIDQwNFxuICAgKiBAc3VtbWFyeSBDcmVhdGVzIHBhZ2VzIGZvciBzcGVjaWZpYyB0cmFuc2FjdGlvblxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIHBhZ2VzIExpc3Qgb2YgcGFnZXNcbiAgICogQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSURcbiAgICogQHBhcmFtIHRlbmFudElkXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyBjcmVhdGVQYWdlcyAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgcGFnZXM6IFBhZ2VEVE8sIHRyYW5zYWN0aW9uSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PiB7XG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdHJhbnNhY3Rpb25zL3t0cmFuc2FjdGlvbklkfS9wYWdlcydcbiAgICAgIC5yZXBsYWNlKCd7JyArICd0cmFuc2FjdGlvbklkJyArICd9JywgU3RyaW5nKHRyYW5zYWN0aW9uSWQpKTtcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlUGFnZXMuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAncGFnZXMnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChwYWdlcyA9PT0gbnVsbCB8fCBwYWdlcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBwYWdlcyB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZVBhZ2VzLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RyYW5zYWN0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0cmFuc2FjdGlvbklkID09PSBudWxsIHx8IHRyYW5zYWN0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdHJhbnNhY3Rpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZVBhZ2VzLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVQYWdlcy4nKTtcbiAgICB9XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xuXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XG5cbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICAgIGJvZHk6IHBhZ2VzLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIGEgbGlzdCBvZiB2YXJpYmFsZXMgYW5kIGFkZCB0aGVtIHRvIGFuIGV4aXN0aW5nIFRyYW5zYWN0aW9uLCBpZiB0aGUgVHJhbnNhY3Rpb24gbm90IGV4aXN0cyB3aWxsIHJldHVybiBIVFRQIGNvZGUgNDA0XG4gICAqIEBzdW1tYXJ5IENyZWF0ZXMgdmFyaWFibGVzIGZvciBzcGVjaWZpYyB0cmFuc2FjdGlvblxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIHZhcmlhYmxlcyBMaXN0IG9mIHZhcmlhYmxlc1xuICAgKiBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRFxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGVudlxuICAgKi9cbiAgcHVibGljIGNyZWF0ZVZhcmlhYmxlcyAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgdmFyaWFibGVzOiBWYXJpYWJsZURUTywgdHJhbnNhY3Rpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMve3RyYW5zYWN0aW9uSWR9L3ZhcmlhYmxlcydcbiAgICAgIC5yZXBsYWNlKCd7JyArICd0cmFuc2FjdGlvbklkJyArICd9JywgU3RyaW5nKHRyYW5zYWN0aW9uSWQpKTtcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVmFyaWFibGVzLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3ZhcmlhYmxlcycgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHZhcmlhYmxlcyA9PT0gbnVsbCB8fCB2YXJpYWJsZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdmFyaWFibGVzIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVmFyaWFibGVzLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RyYW5zYWN0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0cmFuc2FjdGlvbklkID09PSBudWxsIHx8IHRyYW5zYWN0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdHJhbnNhY3Rpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZVZhcmlhYmxlcy4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVmFyaWFibGVzLicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgYm9keTogdmFyaWFibGVzLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIFRyYW5zYWN0aW9uIGJ5IGlkLCBpZiBub3QgZXhpc3RzIEhUVFAgY29kZSA0MDQgcmV0dXJuZWRcbiAgICogQHN1bW1hcnkgUmVhZHMgc3BlY2lmaWMgVHJhbnNhY3Rpb24gZnJvbSBSRFNcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XG4gICAqIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElEXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxuICAgKiBAcGFyYW0gZW52XG4gICAqL1xuICBwdWJsaWMgZ2V0VHJhbnNhY3Rpb24gKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHRyYW5zYWN0aW9uSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PiB7XG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdHJhbnNhY3Rpb25zL3t0cmFuc2FjdGlvbklkfSdcbiAgICAgIC5yZXBsYWNlKCd7JyArICd0cmFuc2FjdGlvbklkJyArICd9JywgU3RyaW5nKHRyYW5zYWN0aW9uSWQpKTtcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0VHJhbnNhY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndHJhbnNhY3Rpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgdHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0VHJhbnNhY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldFRyYW5zYWN0aW9uLicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFJlYWRzIHJlc3VsdHMgZnJvbSBSRFMgdXNpbmcgdGhlIGJhdGNoSWQgcmV0dXJuZWQgZnJvbSAnT2ZmbGluZSByZWFkIG9mIFRyYW5zYWN0aW9ucycgKC9yZHMvYmF0Y2gpXG4gICAqIEBzdW1tYXJ5IEdldHMgdGhlIGJhdGNoIHJldHJpZXZlIHJlc3VsdHMgaW4gYSB6aXAgZmlsZVxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIGJhdGNoSWQgQmF0Y2ggRFxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGVudlxuICAgKi9cbiAgcHVibGljIGdldFRyYW5zYWN0aW9uQmF0Y2hSZXN1bHQgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIGJhdGNoSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQXJyYXk8c3RyaW5nPjsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMvcmVzdWx0L3tiYXRjaElkfSdcbiAgICAgIC5yZXBsYWNlKCd7JyArICdiYXRjaElkJyArICd9JywgU3RyaW5nKGJhdGNoSWQpKTtcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0VHJhbnNhY3Rpb25CYXRjaFJlc3VsdC4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdiYXRjaElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYmF0Y2hJZCA9PT0gbnVsbCB8fCBiYXRjaElkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGJhdGNoSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbkJhdGNoUmVzdWx0LicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbkJhdGNoUmVzdWx0LicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgfTtcblxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xuXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFycmF5PHN0cmluZz47ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogUmVhZHMgVHJhbnNhY3Rpb25zIGZyb20gUkRTIGJ5IHRpbWUgcmFuZ2UsIGN1c3RvbWVyIGlkIG9yL2FuZCBleHRlcm5hbFN5c3RlbUlkLCBpZiBhbGwgdGhlIHBhcmFtZXRlcnMgYXJlIGVtcHR5IHdpbGwgcmVhZCBhbGwgVHJhbnNhY3Rpb25zLiBJbiBvdGggY2FzZXMgdGhlIG1heGltdW0gcmVzdWx0cyBjYW4gYmUgcmV0cmlldmVkIGJ5IHRoaXMgQVBJIGlzIDEwMDAsIGlmIHlvdSBuZWVkIHRvIHJldHJpZXZlIG1vcmUgcGxlYXNlIHVzZSB0aGUgYmF0Y2ggcmV0cmlldmUgQVBJIC9yZHMvYmF0Y2hcbiAgICogQHN1bW1hcnkgUmVhZHMgbGlzdCBvZiBUcmFuc2FjdGlvbiBieSBjcml0ZXJpYVxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcbiAgICogQHBhcmFtIHRlbmFudElkXG4gICAqIEBwYXJhbSB0aW1lRnJvbSBUaGUgc3RhcnQgdGltZVxuICAgKiBAcGFyYW0gdGltZVRvIFRoZSBlbmQgdGltZVxuICAgKiBAcGFyYW0gY3VzdG9tZXJJZCBDdXN0b21lciBJRFxuICAgKiBAcGFyYW0gZXh0ZXJuYWxTeXN0ZW1JZCBFeHRlcm5hbFN5c3RlbSBJRFxuICAgKiBAcGFyYW0gc291cmNlIFRyYW5zYWN0aW9uIHNvdXJjZVxuICAgKiBAcGFyYW0gY2F0ZWdvcnlJZCBDYXRlZ29yeSBJRFxuICAgKiBAcGFyYW0gdmFyaWFibGVzIFZhcmlhYmxlcyBsaXN0IHRvIHJldHJpZXZlLCBpZiBub3QgcGFzc2VkIG5vdGhpbmcgd2lsbCBiZSByZXRyaWV2ZWQsIGlmIHBhc3MgdGhlIGtleXdvcmQgJiMzOTthbGwmIzM5OywgYWxsIHZhcmliYWxlcyB3aWxsIGJlIHJldHVybmVkXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyBnZXRUcmFuc2FjdGlvbnMgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIHRpbWVGcm9tPzogbnVtYmVyLCB0aW1lVG8/OiBudW1iZXIsIGN1c3RvbWVySWQ/OiBzdHJpbmcsIGV4dGVybmFsU3lzdGVtSWQ/OiBzdHJpbmcsIHNvdXJjZT86IHN0cmluZywgY2F0ZWdvcnlJZD86IHN0cmluZywgdmFyaWFibGVzPzogTW9kZWxPYmplY3QsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFycmF5PFRyYW5zYWN0aW9uRFRPPjsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMnO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbnMuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldFRyYW5zYWN0aW9ucy4nKTtcbiAgICB9XG5cbiAgICBpZiAodGltZUZyb20gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlQYXJhbWV0ZXJzWyd0aW1lRnJvbSddID0gdGltZUZyb207XG4gICAgfVxuXG4gICAgaWYgKHRpbWVUbyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ3RpbWVUbyddID0gdGltZVRvO1xuICAgIH1cblxuICAgIGlmIChjdXN0b21lcklkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1snY3VzdG9tZXJJZCddID0gY3VzdG9tZXJJZDtcbiAgICB9XG5cbiAgICBpZiAoZXh0ZXJuYWxTeXN0ZW1JZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ2V4dGVybmFsU3lzdGVtSWQnXSA9IGV4dGVybmFsU3lzdGVtSWQ7XG4gICAgfVxuXG4gICAgaWYgKHNvdXJjZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ3NvdXJjZSddID0gc291cmNlO1xuICAgIH1cblxuICAgIGlmIChjYXRlZ29yeUlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1snY2F0ZWdvcnlJZCddID0gY2F0ZWdvcnlJZDtcbiAgICB9XG5cbiAgICBpZiAodmFyaWFibGVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1sndmFyaWFibGVzJ10gPSB2YXJpYWJsZXM7XG4gICAgfVxuXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xuXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xuXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcblxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xuXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XG4gICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQXJyYXk8VHJhbnNhY3Rpb25EVE8+OyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFRoaXMgQVBJIHJlYWRzIFRyYW5zYWN0aW9ucyBhc3luY2hyb25vdXNseSwgYSBiYXRjaElkIGdlbmVyYXRlZCBhbmQgcmV0dXJuZWQgaW1tZWRpYXRseSB0byB0aGUgY2FsbGVyIGFzIEhUVFAgaGVhZGVyLCB0aGVuIGFuIGFzeW5jIHNlcnZpY2UgY2FsbCB0byBxdWVyeSB0aGUgVHJhbnNhY3Rpb25zIGJ5IHRoZSB0aW1lIHJhbmdlLCBjdXN0b21lciBpZCBvci9hbmQgZXh0ZXJuYWxTeXN0ZW1JZCBleGVjdXRlZCBhbmQgc3RvcmVzIHRoZSByZXN1bHRzIHVzaW5nIHRoZSBiYXRjaElkIGdlbmVyYXRlZCBlYXJsaWVyLCB0aGlzIGJhdGNoSWQgd2lsbCBiZSB1c2VkIGxhdGVyIHRvIGdldCB0aGUgYmF0Y2ggcHJvY2Vzc2luZyByZXN1bHRzXG4gICAqIEBzdW1tYXJ5IE9mZmxpbmUgcmVhZCBvZiBUcmFuc2FjdGlvbnNcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxuICAgKiBAcGFyYW0gdGltZUZyb20gVGhlIHN0YXJ0IHRpbWVcbiAgICogQHBhcmFtIHRpbWVUbyBUaGUgZW5kIHRpbWVcbiAgICogQHBhcmFtIGN1c3RvbWVySWQgQ3VzdG9tZXIgSURcbiAgICogQHBhcmFtIGV4dGVybmFsU3lzdGVtSWQgRXh0ZXJuYWxTeXN0ZW0gSURcbiAgICogQHBhcmFtIHNvdXJjZSBUcmFuc2FjdGlvbiBzb3VyY2VcbiAgICogQHBhcmFtIGNhdGVnb3J5SWQgQ2F0ZWdvcnkgSURcbiAgICogQHBhcmFtIHZhcmlhYmxlcyBWYXJpYWJsZXMgbGlzdCB0byByZXRyaWV2ZSwgaWYgbm90IHBhc3NlZCBub3RoaW5nIHdpbGwgYmUgcmV0cmlldmVkLCBpZiBwYXNzIHRoZSBrZXl3b3JkICYjMzk7YWxsJiMzOTssIGFsbCB2YXJpYmFsZXMgd2lsbCBiZSByZXR1cm5lZFxuICAgKiBAcGFyYW0gZW52XG4gICAqL1xuICBwdWJsaWMgZ2V0VHJhbnNhY3Rpb25zSW5CYXRjaCAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgdGltZUZyb20/OiBudW1iZXIsIHRpbWVUbz86IG51bWJlciwgY3VzdG9tZXJJZD86IHN0cmluZywgZXh0ZXJuYWxTeXN0ZW1JZD86IHN0cmluZywgc291cmNlPzogc3RyaW5nLCBjYXRlZ29yeUlkPzogc3RyaW5nLCB2YXJpYWJsZXM/OiBNb2RlbE9iamVjdCwgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQmF0Y2hSZXNwb25zZTsgIH0+IHtcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMvYmF0Y2gnO1xuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XG5cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbnNJbkJhdGNoLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbnNJbkJhdGNoLicpO1xuICAgIH1cblxuICAgIGlmICh0aW1lRnJvbSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ3RpbWVGcm9tJ10gPSB0aW1lRnJvbTtcbiAgICB9XG5cbiAgICBpZiAodGltZVRvICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1sndGltZVRvJ10gPSB0aW1lVG87XG4gICAgfVxuXG4gICAgaWYgKGN1c3RvbWVySWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlQYXJhbWV0ZXJzWydjdXN0b21lcklkJ10gPSBjdXN0b21lcklkO1xuICAgIH1cblxuICAgIGlmIChleHRlcm5hbFN5c3RlbUlkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1snZXh0ZXJuYWxTeXN0ZW1JZCddID0gZXh0ZXJuYWxTeXN0ZW1JZDtcbiAgICB9XG5cbiAgICBpZiAoc291cmNlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1snc291cmNlJ10gPSBzb3VyY2U7XG4gICAgfVxuXG4gICAgaWYgKGNhdGVnb3J5SWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlQYXJhbWV0ZXJzWydjYXRlZ29yeUlkJ10gPSBjYXRlZ29yeUlkO1xuICAgIH1cblxuICAgIGlmICh2YXJpYWJsZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlQYXJhbWV0ZXJzWyd2YXJpYWJsZXMnXSA9IHZhcmlhYmxlcztcbiAgICB9XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xuXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XG5cbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQmF0Y2hSZXNwb25zZTsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBHZXRzIGEgbGlzdCBvZiBUcmFuc2FjdGlvbkRUT3MgYW5kIGxvYWRzIHRoZW0gaW50byBSRFMsIFJEUyBjcmVhdGVzIFRyYW5zYWN0aW9uIGZvciBlYWNoIERUTyBpbiB0aGUgbGlzdFxuICAgKiBAc3VtbWFyeSBMb2FkcyBsaXN0IG9mIHRyYW5zYWN0aW9ucyB0byBSRFNcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XG4gICAqIEBwYXJhbSB0cmFuc2FjdGlvbnMgTGlzdCBvZiB0cmFuc2FjdGlvbnNcbiAgICogQHBhcmFtIHRlbmFudElkXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyBsb2FkVHJhbnNhY3Rpb25zIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCB0cmFuc2FjdGlvbnM6IFRyYW5zYWN0aW9uRFRPLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5PzogYW55OyAgfT4ge1xuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RyYW5zYWN0aW9ucyc7XG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcblxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGxvYWRUcmFuc2FjdGlvbnMuJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndHJhbnNhY3Rpb25zJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodHJhbnNhY3Rpb25zID09PSBudWxsIHx8IHRyYW5zYWN0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbnMgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBsb2FkVHJhbnNhY3Rpb25zLicpO1xuICAgIH1cblxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBsb2FkVHJhbnNhY3Rpb25zLicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXG4gICAgICBqc29uOiB0cnVlLFxuICAgICAgYm9keTogdHJhbnNhY3Rpb25zLFxuICAgIH07XG5cbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcblxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5PzogYW55OyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIFN0YXJ0cyBhIHRyYW5zYWN0aW9uIGFuZCByZXR1cm4gYW4gZW1wdHkgVHJhbnNhY3Rpb25EVE8gd2l0aCBpZCB0byB0aGUgY2FsbGVyLCBjYWxsZXIgYWxzbyBjYW4gc2VuZCB0aGUgZXh0ZXJuYWxTeXN0ZW1JZCB0byBiZSB1c2VkIGxhdGVyIHRvIGdldCB0cmFuc2FjdGlvbnNcbiAgICogQHN1bW1hcnkgU3RhcnRzIGEgdHJhbnNhY3Rpb24gaW4gUkRTXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxuICAgKiBAcGFyYW0gc291cmNlIFRyYW5zYWN0aW9uIHNvdXJjZVxuICAgKiBAcGFyYW0gdGVuYW50SWRcbiAgICogQHBhcmFtIGV4dGVybmFsU3lzdGVtSWQgRXh0ZXJuYWwgU3lzdGVtIElEXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyBzdGFydFRyYW5zYWN0aW9uIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBzb3VyY2U6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZXh0ZXJuYWxTeXN0ZW1JZD86IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PiB7XG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdHJhbnNhY3Rpb25zL3N0YXJ0JztcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgc3RhcnRUcmFuc2FjdGlvbi4nKTtcbiAgICB9XG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdzb3VyY2UnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmIChzb3VyY2UgPT09IG51bGwgfHwgc291cmNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHNvdXJjZSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHN0YXJ0VHJhbnNhY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHN0YXJ0VHJhbnNhY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgaWYgKGV4dGVybmFsU3lzdGVtSWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlQYXJhbWV0ZXJzWydleHRlcm5hbFN5c3RlbUlkJ10gPSBleHRlcm5hbFN5c3RlbUlkO1xuICAgIH1cblxuICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnlQYXJhbWV0ZXJzWydzb3VyY2UnXSA9IHNvdXJjZTtcbiAgICB9XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XG5cbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xuXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XG5cbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxuICAgICAganNvbjogdHJ1ZSxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICAvKipcbiAgICogVXBkYXRlcyBzcGVjaWZpYyBUcmFuc2FjdGlvbiBpbiBSRFMgdXNpbmcgdGhlIHRyYW5zYWN0aW9uIGlkIGFuZCB1cGRhdGVkIFRyYW5zYWN0aW9uRFRPLCBIVFRQIGNvZGUgNDA0IHJldHVybmVkIGlmIHRoZSBUcmFuc2FjdGlvbiBub3QgZXhpc3RzXG4gICAqIEBzdW1tYXJ5IFVwZGF0ZXMgc3BlY2lmaWMgdHJhbnNhY3Rpb25cbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XG4gICAqIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElEXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxuICAgKiBAcGFyYW0gdHJhbnNhY3Rpb25EdG8gVHJhbnNhY3Rpb24gRFRPXG4gICAqIEBwYXJhbSBlbnZcbiAgICovXG4gIHB1YmxpYyB1cGRhdGVUcmFuc2FjdGlvbiAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgdHJhbnNhY3Rpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCB0cmFuc2FjdGlvbkR0bz86IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PiB7XG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdHJhbnNhY3Rpb25zL3t0cmFuc2FjdGlvbklkfSdcbiAgICAgIC5yZXBsYWNlKCd7JyArICd0cmFuc2FjdGlvbklkJyArICd9JywgU3RyaW5nKHRyYW5zYWN0aW9uSWQpKTtcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xuXG5cbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlVHJhbnNhY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndHJhbnNhY3Rpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXG4gICAgaWYgKHRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgdHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlVHJhbnNhY3Rpb24uJyk7XG4gICAgfVxuXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZVRyYW5zYWN0aW9uLicpO1xuICAgIH1cblxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcblxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcblxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XG5cbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcblxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiAnUFVUJyxcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcbiAgICAgIGpzb246IHRydWUsXG4gICAgICBib2R5OiB0cmFuc2FjdGlvbkR0byxcbiAgICB9O1xuXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuIl19