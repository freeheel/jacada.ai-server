"use strict";
/**
 * Raw Data Service API
 * Raw data service (aka rds) API's documentation
 *
 * OpenAPI spec version: 1.0.0
 *
 *
 * NOTE: This class is auto generated by the swagger code generator program.
 * https://github.com/swagger-api/swagger-codegen.git
 * Do not edit the class manually.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const request = require("request");
const Promise = require("bluebird");
let defaultBasePath = 'https://gointeract.io/rds';
// ===============================================
// This file is autogenerated - Please do not edit
// ===============================================
/* tslint:disable:no-unused-variable */
class AggregationCreateResponse {
}
exports.AggregationCreateResponse = AggregationCreateResponse;
class AggregationDTO {
}
exports.AggregationDTO = AggregationDTO;
class AggregationResponse {
}
exports.AggregationResponse = AggregationResponse;
class BatchResponse {
}
exports.BatchResponse = BatchResponse;
class CustomerDTO {
}
exports.CustomerDTO = CustomerDTO;
class EventDTO {
}
exports.EventDTO = EventDTO;
class FieldDTO {
}
exports.FieldDTO = FieldDTO;
class PageDTO {
}
exports.PageDTO = PageDTO;
class QueryFieldsDTO {
}
exports.QueryFieldsDTO = QueryFieldsDTO;
class TenantInfoDTO {
}
exports.TenantInfoDTO = TenantInfoDTO;
class TransactionDTO {
}
exports.TransactionDTO = TransactionDTO;
class Variable {
}
exports.Variable = Variable;
class VariableDTO {
}
exports.VariableDTO = VariableDTO;
class VariableValue {
}
exports.VariableValue = VariableValue;
class HttpBasicAuth {
    applyToRequest(requestOptions) {
        requestOptions.auth = {
            username: this.username, password: this.password
        };
    }
}
exports.HttpBasicAuth = HttpBasicAuth;
class ApiKeyAuth {
    constructor(location, paramName) {
        this.location = location;
        this.paramName = paramName;
    }
    applyToRequest(requestOptions) {
        if (this.location == "query") {
            requestOptions.qs[this.paramName] = this.apiKey;
        }
        else if (this.location == "header" && requestOptions && requestOptions.headers) {
            requestOptions.headers[this.paramName] = this.apiKey;
        }
    }
}
exports.ApiKeyAuth = ApiKeyAuth;
class OAuth {
    applyToRequest(requestOptions) {
        if (requestOptions && requestOptions.headers) {
            requestOptions.headers["Authorization"] = "Bearer " + this.accessToken;
        }
    }
}
exports.OAuth = OAuth;
class VoidAuth {
    applyToRequest(_) {
        // Do nothing
    }
}
exports.VoidAuth = VoidAuth;
var AggregationcontrollerApiApiKeys;
(function (AggregationcontrollerApiApiKeys) {
})(AggregationcontrollerApiApiKeys = exports.AggregationcontrollerApiApiKeys || (exports.AggregationcontrollerApiApiKeys = {}));
class AggregationcontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[AggregationcontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Aggregates raw data by given query.   If the query is invalid HTTP code 406 is returned
     * @summary Aggregates raw data
     * @param applicationKey RDS application key
     * @param aggregationDTO AggregationDTO includes the Aggregation query.   The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;, &#39;startTimestamp&#39; and &#39;endTimestamp&#39; in $match stage
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    aggregate(applicationKey, aggregationDTO, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling aggregate.');
        }
        // verify required parameter 'aggregationDTO' is not null or undefined
        if (aggregationDTO === null || aggregationDTO === undefined) {
            throw new Error('Required parameter aggregationDTO was null or undefined when calling aggregate.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling aggregate.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: aggregationDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Returns aggregated data by given query.   If the query is invalid HTTP code 406 is returned
     * @summary Retrieves aggregated data
     * @param applicationKey RDS application key
     * @param query Aggregation query.  The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;
     * @param aggregationId Aggregation definition id
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    aggregationRetrieve(applicationKey, query, aggregationId, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/results/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling aggregationRetrieve.');
        }
        // verify required parameter 'query' is not null or undefined
        if (query === null || query === undefined) {
            throw new Error('Required parameter query was null or undefined when calling aggregationRetrieve.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling aggregationRetrieve.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling aggregationRetrieve.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: query,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * For testing the aggregation query before calling the aggregate API.  Will run the query on the past 4 hours and will return the results of the aggregation.  If the query is invalid HTTP code 406 is returned
     * @summary Tests aggregation query of raw data
     * @param applicationKey RDS application key
     * @param query Aggregation test query.  The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;, &#39;startTimestamp&#39; and &#39;endTimestamp&#39; in $match stage
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    aggregationTest(applicationKey, query, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/test';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling aggregationTest.');
        }
        // verify required parameter 'query' is not null or undefined
        if (query === null || query === undefined) {
            throw new Error('Required parameter query was null or undefined when calling aggregationTest.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling aggregationTest.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: query,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Deletes aggregation by id, if the the aggregation not exists HTTP code 404 returned
     * @summary Deletes a specific aggregation in RDS
     * @param applicationKey
     * @param aggregationId The aggregation ID
     * @param tenantId
     * @param env
     */
    deleteAggregation(applicationKey, aggregationId, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling deleteAggregation.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling deleteAggregation.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling deleteAggregation.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'DELETE',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Returns aggregated data by given query.
     * @summary Retrieves aggregated data by find query
     * @param applicationKey RDS application key
     * @param queryFieldsDTO Fields to use in the find query.
     * @param aggregationId Aggregation definition id
     * @param tenantId Tenant Id
     * @param env Tenant environment name (Interact multi-emvironment)
     */
    findQueryRetrieve(applicationKey, queryFieldsDTO, aggregationId, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/results/simple/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling findQueryRetrieve.');
        }
        // verify required parameter 'queryFieldsDTO' is not null or undefined
        if (queryFieldsDTO === null || queryFieldsDTO === undefined) {
            throw new Error('Required parameter queryFieldsDTO was null or undefined when calling findQueryRetrieve.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling findQueryRetrieve.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling findQueryRetrieve.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: queryFieldsDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Get list of aggregations created for tenant
     * @summary Gets list of aggregations
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    getAggregations(applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getAggregations.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getAggregations.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Updates aggregation by id, if the the aggregation not exists HTTP code 404 returned
     * @summary Updates a specific aggregation in RDS
     * @param applicationKey
     * @param aggregationId The aggregation ID
     * @param aggregationDTO AggregationDTO includes the Aggregation query.   The aggregation query json must be escaped.   See https://www.freeformatter.com/json-escape.html for online json escaping  Illegal keywords: &#39;$where&#39;, &#39;$lookup&#39;, &#39;$out&#39;, &#39;$collStats&#39;, &#39;$indexStats&#39;, &#39;startTimestamp&#39; and &#39;endTimestamp&#39; in $match stage
     * @param tenantId
     * @param env
     */
    updateAggregation(applicationKey, aggregationId, aggregationDTO, tenantId, env) {
        const localVarPath = this.basePath + '/aggregation/{aggregationId}'
            .replace('{' + 'aggregationId' + '}', String(aggregationId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateAggregation.');
        }
        // verify required parameter 'aggregationId' is not null or undefined
        if (aggregationId === null || aggregationId === undefined) {
            throw new Error('Required parameter aggregationId was null or undefined when calling updateAggregation.');
        }
        // verify required parameter 'aggregationDTO' is not null or undefined
        if (aggregationDTO === null || aggregationDTO === undefined) {
            throw new Error('Required parameter aggregationDTO was null or undefined when calling updateAggregation.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateAggregation.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: aggregationDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.AggregationcontrollerApi = AggregationcontrollerApi;
var CustomercontrollerApiApiKeys;
(function (CustomercontrollerApiApiKeys) {
})(CustomercontrollerApiApiKeys = exports.CustomercontrollerApiApiKeys || (exports.CustomercontrollerApiApiKeys = {}));
class CustomercontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[CustomercontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Creates the customer in RDS from the CustomerDTO in the body and return HTTP code 201 (created)
     * @summary Creates customer in RDS
     * @param applicationKey
     * @param customerDto The customer body
     * @param tenantId
     * @param env
     */
    createCustomer(applicationKey, customerDto, tenantId, env) {
        const localVarPath = this.basePath + '/customers';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createCustomer.');
        }
        // verify required parameter 'customerDto' is not null or undefined
        if (customerDto === null || customerDto === undefined) {
            throw new Error('Required parameter customerDto was null or undefined when calling createCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: customerDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Deletes customer by id, if the the customer not exists HTTP code 404 returned
     * @summary Deletes a customer in RDS
     * @param applicationKey
     * @param customerId The customer ID
     * @param tenantId
     * @param env
     */
    deleteCustomer(applicationKey, customerId, tenantId, env) {
        const localVarPath = this.basePath + '/customers/{customerId}'
            .replace('{' + 'customerId' + '}', String(customerId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling deleteCustomer.');
        }
        // verify required parameter 'customerId' is not null or undefined
        if (customerId === null || customerId === undefined) {
            throw new Error('Required parameter customerId was null or undefined when calling deleteCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling deleteCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'DELETE',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads the customer from RDS by customer id, if the customer not exists in RDS, HTTP error 404 returned
     * @summary Gets specific customer from RDS by customer id
     * @param applicationKey
     * @param customerId The customer ID
     * @param tenantId
     * @param env
     */
    readCustomer(applicationKey, customerId, tenantId, env) {
        const localVarPath = this.basePath + '/customers/{customerId}'
            .replace('{' + 'customerId' + '}', String(customerId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling readCustomer.');
        }
        // verify required parameter 'customerId' is not null or undefined
        if (customerId === null || customerId === undefined) {
            throw new Error('Required parameter customerId was null or undefined when calling readCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling readCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Using customer id and CustomerDTO will update the spcific customer and return HTTP code 200 if success or if the customer not found HTTP code 404
     * @summary Updates customer in RDS
     * @param applicationKey
     * @param customerDto The customer body
     * @param customerId The customer ID
     * @param tenantId
     * @param env
     */
    updateCustomer(applicationKey, customerDto, customerId, tenantId, env) {
        const localVarPath = this.basePath + '/customers/{customerId}'
            .replace('{' + 'customerId' + '}', String(customerId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateCustomer.');
        }
        // verify required parameter 'customerDto' is not null or undefined
        if (customerDto === null || customerDto === undefined) {
            throw new Error('Required parameter customerDto was null or undefined when calling updateCustomer.');
        }
        // verify required parameter 'customerId' is not null or undefined
        if (customerId === null || customerId === undefined) {
            throw new Error('Required parameter customerId was null or undefined when calling updateCustomer.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateCustomer.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: customerDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.CustomercontrollerApi = CustomercontrollerApi;
var TenantinfocontrollerApiApiKeys;
(function (TenantinfocontrollerApiApiKeys) {
})(TenantinfocontrollerApiApiKeys = exports.TenantinfocontrollerApiApiKeys || (exports.TenantinfocontrollerApiApiKeys = {}));
class TenantinfocontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[TenantinfocontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Creates tenant info in RDS, the tenant info contains the configuration of the tenant, RDS will use this configuration to POST a notification after batch retrieve processing completed to notifyUrl and relevant http headers.
     * @summary Creates tenant info in RDS
     * @param tenantInfoDto tenantInfoDto
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    createTenantInfo(tenantInfoDto, applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/tenantInfo';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'tenantInfoDto' is not null or undefined
        if (tenantInfoDto === null || tenantInfoDto === undefined) {
            throw new Error('Required parameter tenantInfoDto was null or undefined when calling createTenantInfo.');
        }
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createTenantInfo.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createTenantInfo.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: tenantInfoDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads the tenant info from RDS, HTTP code 404 will be returned if the tenant has no info in RDS
     * @summary Reads the tenant info from RDS
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    readTenantInfo(applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/tenantInfo';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling readTenantInfo.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling readTenantInfo.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Updates a tenant info by id and TenantInfoDTO
     * @summary Updates tenant info in RDS
     * @param tenantInfoDTO tenantInfoDTO
     * @param applicationKey
     * @param tenantId
     * @param env
     */
    updateTenantInfo(tenantInfoDTO, applicationKey, tenantId, env) {
        const localVarPath = this.basePath + '/tenantInfo';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'tenantInfoDTO' is not null or undefined
        if (tenantInfoDTO === null || tenantInfoDTO === undefined) {
            throw new Error('Required parameter tenantInfoDTO was null or undefined when calling updateTenantInfo.');
        }
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateTenantInfo.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateTenantInfo.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: tenantInfoDTO,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.TenantinfocontrollerApi = TenantinfocontrollerApi;
var TransactioncontrollerApiApiKeys;
(function (TransactioncontrollerApiApiKeys) {
})(TransactioncontrollerApiApiKeys = exports.TransactioncontrollerApiApiKeys || (exports.TransactioncontrollerApiApiKeys = {}));
class TransactioncontrollerApi {
    constructor(basePathOrUsername, password, basePath) {
        this._basePath = defaultBasePath;
        this.defaultHeaders = {};
        this._useQuerystring = false;
        this.authentications = {
            'default': new VoidAuth(),
        };
        if (password) {
            if (basePath) {
                this.basePath = basePath;
            }
        }
        else {
            if (basePathOrUsername) {
                this.basePath = basePathOrUsername;
            }
        }
    }
    set useQuerystring(value) {
        this._useQuerystring = value;
    }
    set basePath(basePath) {
        this._basePath = basePath;
    }
    get basePath() {
        return this._basePath;
    }
    setDefaultAuthentication(auth) {
        this.authentications.default = auth;
    }
    setApiKey(key, value) {
        this.authentications[TransactioncontrollerApiApiKeys[key]].apiKey = value;
    }
    /**
     * Adds addtional data to an existing Transaction
     * @summary Adds additional data to Transaction
     * @param applicationKey
     * @param additionalData Map of additional data
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createAdditionalData(applicationKey, additionalData, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/additionalData'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createAdditionalData.');
        }
        // verify required parameter 'additionalData' is not null or undefined
        if (additionalData === null || additionalData === undefined) {
            throw new Error('Required parameter additionalData was null or undefined when calling createAdditionalData.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createAdditionalData.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createAdditionalData.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: additionalData,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of events and add them to an existing Transaction, if the Transaction not exists will return HTTP code 404
     * @summary Creates events for specific transaction
     * @param applicationKey
     * @param events List of events
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createEvents(applicationKey, events, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/events'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createEvents.');
        }
        // verify required parameter 'events' is not null or undefined
        if (events === null || events === undefined) {
            throw new Error('Required parameter events was null or undefined when calling createEvents.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createEvents.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createEvents.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: events,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of pages and add them to an existing Transaction, if the Transaction not exists will return HTTP code 404
     * @summary Creates pages for specific transaction
     * @param applicationKey
     * @param pages List of pages
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createPages(applicationKey, pages, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/pages'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createPages.');
        }
        // verify required parameter 'pages' is not null or undefined
        if (pages === null || pages === undefined) {
            throw new Error('Required parameter pages was null or undefined when calling createPages.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createPages.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createPages.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: pages,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of varibales and add them to an existing Transaction, if the Transaction not exists will return HTTP code 404
     * @summary Creates variables for specific transaction
     * @param applicationKey
     * @param variables List of variables
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    createVariables(applicationKey, variables, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}/variables'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling createVariables.');
        }
        // verify required parameter 'variables' is not null or undefined
        if (variables === null || variables === undefined) {
            throw new Error('Required parameter variables was null or undefined when calling createVariables.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling createVariables.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling createVariables.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: variables,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets Transaction by id, if not exists HTTP code 404 returned
     * @summary Reads specific Transaction from RDS
     * @param applicationKey
     * @param transactionId Transaction ID
     * @param tenantId
     * @param env
     */
    getTransaction(applicationKey, transactionId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransaction.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling getTransaction.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransaction.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads results from RDS using the batchId returned from 'Offline read of Transactions' (/rds/batch)
     * @summary Gets the batch retrieve results in a zip file
     * @param applicationKey
     * @param batchId Batch D
     * @param tenantId
     * @param env
     */
    getTransactionBatchResult(applicationKey, batchId, tenantId, env) {
        const localVarPath = this.basePath + '/transactions/result/{batchId}'
            .replace('{' + 'batchId' + '}', String(batchId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransactionBatchResult.');
        }
        // verify required parameter 'batchId' is not null or undefined
        if (batchId === null || batchId === undefined) {
            throw new Error('Required parameter batchId was null or undefined when calling getTransactionBatchResult.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransactionBatchResult.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Reads Transactions from RDS by time range, customer id or/and externalSystemId, if all the parameters are empty will read all Transactions. In oth cases the maximum results can be retrieved by this API is 1000, if you need to retrieve more please use the batch retrieve API /rds/batch
     * @summary Reads list of Transaction by criteria
     * @param applicationKey
     * @param tenantId
     * @param timeFrom The start time
     * @param timeTo The end time
     * @param customerId Customer ID
     * @param externalSystemId ExternalSystem ID
     * @param source Transaction source
     * @param categoryId Category ID
     * @param variables Variables list to retrieve, if not passed nothing will be retrieved, if pass the keyword &#39;all&#39;, all varibales will be returned
     * @param env
     */
    getTransactions(applicationKey, tenantId, timeFrom, timeTo, customerId, externalSystemId, source, categoryId, variables, env) {
        const localVarPath = this.basePath + '/transactions';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransactions.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransactions.');
        }
        if (timeFrom !== undefined) {
            queryParameters['timeFrom'] = timeFrom;
        }
        if (timeTo !== undefined) {
            queryParameters['timeTo'] = timeTo;
        }
        if (customerId !== undefined) {
            queryParameters['customerId'] = customerId;
        }
        if (externalSystemId !== undefined) {
            queryParameters['externalSystemId'] = externalSystemId;
        }
        if (source !== undefined) {
            queryParameters['source'] = source;
        }
        if (categoryId !== undefined) {
            queryParameters['categoryId'] = categoryId;
        }
        if (variables !== undefined) {
            queryParameters['variables'] = variables;
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'GET',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * This API reads Transactions asynchronously, a batchId generated and returned immediatly to the caller as HTTP header, then an async service call to query the Transactions by the time range, customer id or/and externalSystemId executed and stores the results using the batchId generated earlier, this batchId will be used later to get the batch processing results
     * @summary Offline read of Transactions
     * @param applicationKey
     * @param tenantId
     * @param timeFrom The start time
     * @param timeTo The end time
     * @param customerId Customer ID
     * @param externalSystemId ExternalSystem ID
     * @param source Transaction source
     * @param categoryId Category ID
     * @param variables Variables list to retrieve, if not passed nothing will be retrieved, if pass the keyword &#39;all&#39;, all varibales will be returned
     * @param env
     */
    getTransactionsInBatch(applicationKey, tenantId, timeFrom, timeTo, customerId, externalSystemId, source, categoryId, variables, env) {
        const localVarPath = this.basePath + '/transactions/batch';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling getTransactionsInBatch.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling getTransactionsInBatch.');
        }
        if (timeFrom !== undefined) {
            queryParameters['timeFrom'] = timeFrom;
        }
        if (timeTo !== undefined) {
            queryParameters['timeTo'] = timeTo;
        }
        if (customerId !== undefined) {
            queryParameters['customerId'] = customerId;
        }
        if (externalSystemId !== undefined) {
            queryParameters['externalSystemId'] = externalSystemId;
        }
        if (source !== undefined) {
            queryParameters['source'] = source;
        }
        if (categoryId !== undefined) {
            queryParameters['categoryId'] = categoryId;
        }
        if (variables !== undefined) {
            queryParameters['variables'] = variables;
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Gets a list of TransactionDTOs and loads them into RDS, RDS creates Transaction for each DTO in the list
     * @summary Loads list of transactions to RDS
     * @param applicationKey
     * @param transactions List of transactions
     * @param tenantId
     * @param env
     */
    loadTransactions(applicationKey, transactions, tenantId, env) {
        const localVarPath = this.basePath + '/transactions';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling loadTransactions.');
        }
        // verify required parameter 'transactions' is not null or undefined
        if (transactions === null || transactions === undefined) {
            throw new Error('Required parameter transactions was null or undefined when calling loadTransactions.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling loadTransactions.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: transactions,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Starts a transaction and return an empty TransactionDTO with id to the caller, caller also can send the externalSystemId to be used later to get transactions
     * @summary Starts a transaction in RDS
     * @param applicationKey
     * @param source Transaction source
     * @param tenantId
     * @param externalSystemId External System ID
     * @param env
     */
    startTransaction(applicationKey, source, tenantId, externalSystemId, env) {
        const localVarPath = this.basePath + '/transactions/start';
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling startTransaction.');
        }
        // verify required parameter 'source' is not null or undefined
        if (source === null || source === undefined) {
            throw new Error('Required parameter source was null or undefined when calling startTransaction.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling startTransaction.');
        }
        if (externalSystemId !== undefined) {
            queryParameters['externalSystemId'] = externalSystemId;
        }
        if (source !== undefined) {
            queryParameters['source'] = source;
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'POST',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
    /**
     * Updates specific Transaction in RDS using the transaction id and updated TransactionDTO, HTTP code 404 returned if the Transaction not exists
     * @summary Updates specific transaction
     * @param applicationKey
     * @param transactionId Transaction ID
     * @param tenantId
     * @param transactionDto Transaction DTO
     * @param env
     */
    updateTransaction(applicationKey, transactionId, tenantId, transactionDto, env) {
        const localVarPath = this.basePath + '/transactions/{transactionId}'
            .replace('{' + 'transactionId' + '}', String(transactionId));
        let queryParameters = {};
        let headerParams = Object.assign({}, this.defaultHeaders);
        let formParams = {};
        // verify required parameter 'applicationKey' is not null or undefined
        if (applicationKey === null || applicationKey === undefined) {
            throw new Error('Required parameter applicationKey was null or undefined when calling updateTransaction.');
        }
        // verify required parameter 'transactionId' is not null or undefined
        if (transactionId === null || transactionId === undefined) {
            throw new Error('Required parameter transactionId was null or undefined when calling updateTransaction.');
        }
        // verify required parameter 'tenantId' is not null or undefined
        if (tenantId === null || tenantId === undefined) {
            throw new Error('Required parameter tenantId was null or undefined when calling updateTransaction.');
        }
        headerParams['Application-Key'] = applicationKey;
        headerParams['Tenant-Id'] = tenantId;
        headerParams['Env'] = env;
        let useFormData = false;
        let requestOptions = {
            method: 'PUT',
            qs: queryParameters,
            headers: headerParams,
            uri: localVarPath,
            useQuerystring: this._useQuerystring,
            json: true,
            body: transactionDto,
        };
        this.authentications.default.applyToRequest(requestOptions);
        if (Object.keys(formParams).length) {
            if (useFormData) {
                requestOptions.formData = formParams;
            }
            else {
                requestOptions.form = formParams;
            }
        }
        return new Promise((resolve, reject) => {
            request(requestOptions, (error, response, body) => {
                if (error) {
                    reject(error);
                }
                else {
                    if (response.statusCode >= 200 && response.statusCode <= 299) {
                        resolve({ response: response, body: body });
                    }
                    else {
                        reject({ response: response, body: body });
                    }
                }
            });
        });
    }
}
exports.TransactioncontrollerApi = TransactioncontrollerApi;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSmFjYWRhUkRTQXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiSmFjYWRhUkRTQXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7OztHQVVHOztBQUVILG1DQUFvQztBQUdwQyxvQ0FBcUM7QUFFckMsSUFBSSxlQUFlLEdBQUcsMkJBQTJCLENBQUM7QUFFbEQsa0RBQWtEO0FBQ2xELGtEQUFrRDtBQUNsRCxrREFBa0Q7QUFFbEQsdUNBQXVDO0FBRXZDLE1BQWEseUJBQXlCO0NBRXJDO0FBRkQsOERBRUM7QUFFRCxNQUFhLGNBQWM7Q0FRMUI7QUFSRCx3Q0FRQztBQUVELE1BQWEsbUJBQW1CO0NBRy9CO0FBSEQsa0RBR0M7QUFFRCxNQUFhLGFBQWE7Q0FFekI7QUFGRCxzQ0FFQztBQUVELE1BQWEsV0FBVztDQVF2QjtBQVJELGtDQVFDO0FBRUQsTUFBYSxRQUFRO0NBTXBCO0FBTkQsNEJBTUM7QUFFRCxNQUFhLFFBQVE7Q0FLcEI7QUFMRCw0QkFLQztBQUVELE1BQWEsT0FBTztDQU9uQjtBQVBELDBCQU9DO0FBRUQsTUFBYSxjQUFjO0NBRTFCO0FBRkQsd0NBRUM7QUFFRCxNQUFhLGFBQWE7Q0FHekI7QUFIRCxzQ0FHQztBQUVELE1BQWEsY0FBYztDQWUxQjtBQWZELHdDQWVDO0FBRUQsTUFBYSxRQUFRO0NBT3BCO0FBUEQsNEJBT0M7QUFFRCxNQUFhLFdBQVc7Q0FPdkI7QUFQRCxrQ0FPQztBQUVELE1BQWEsYUFBYTtDQUl6QjtBQUpELHNDQUlDO0FBVUQsTUFBYSxhQUFhO0lBR3hCLGNBQWMsQ0FBQyxjQUErQjtRQUM1QyxjQUFjLENBQUMsSUFBSSxHQUFHO1lBQ3BCLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUTtTQUNqRCxDQUFBO0lBQ0gsQ0FBQztDQUNGO0FBUkQsc0NBUUM7QUFFRCxNQUFhLFVBQVU7SUFHckIsWUFBb0IsUUFBZ0IsRUFBVSxTQUFpQjtRQUEz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SUFBSSxFQUFFLEVBQUU7Z0JBQ2hELElBQUksS0FBSyxFQUFFO29CQUNULE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztpQkFDZjtxQkFBTTtvQkFDTCxJQUFJLFFBQVEsQ0FBQyxVQUFVLElBQUksR0FBRyxJQUFJLFFBQVEsQ0FBQyxVQUFVLElBQUksR0FBRyxFQUFFO3dCQUM1RCxPQUFPLENBQUMsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO3FCQUM3Qzt5QkFBTTt3QkFDTCxNQUFNLENBQUMsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO3FCQUM1QztpQkFDRjtZQUNILENBQUMsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0NBQ0Y7QUFwNUJELDREQW81QkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogUmF3IERhdGEgU2VydmljZSBBUElcclxuICogUmF3IGRhdGEgc2VydmljZSAoYWthIHJkcykgQVBJJ3MgZG9jdW1lbnRhdGlvblxyXG4gKlxyXG4gKiBPcGVuQVBJIHNwZWMgdmVyc2lvbjogMS4wLjBcclxuICpcclxuICpcclxuICogTk9URTogVGhpcyBjbGFzcyBpcyBhdXRvIGdlbmVyYXRlZCBieSB0aGUgc3dhZ2dlciBjb2RlIGdlbmVyYXRvciBwcm9ncmFtLlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vc3dhZ2dlci1hcGkvc3dhZ2dlci1jb2RlZ2VuLmdpdFxyXG4gKiBEbyBub3QgZWRpdCB0aGUgY2xhc3MgbWFudWFsbHkuXHJcbiAqL1xyXG5cclxuaW1wb3J0IHJlcXVlc3QgPSByZXF1aXJlKCdyZXF1ZXN0Jyk7XHJcbi8vaW1wb3J0IGh0dHAgPSByZXF1aXJlKCdodHRwJyk7XHJcbmltcG9ydCAqIGFzIGh0dHAgZnJvbSAnaHR0cCc7XHJcbmltcG9ydCBQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKTtcclxuXHJcbmxldCBkZWZhdWx0QmFzZVBhdGggPSAnaHR0cHM6Ly9nb2ludGVyYWN0LmlvL3Jkcyc7XHJcblxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG4vLyBUaGlzIGZpbGUgaXMgYXV0b2dlbmVyYXRlZCAtIFBsZWFzZSBkbyBub3QgZWRpdFxyXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxyXG5cclxuLyogdHNsaW50OmRpc2FibGU6bm8tdW51c2VkLXZhcmlhYmxlICovXHJcblxyXG5leHBvcnQgY2xhc3MgQWdncmVnYXRpb25DcmVhdGVSZXNwb25zZSB7XHJcbiAgJ2FnZ3JlZ2F0aW9uSWQnOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBZ2dyZWdhdGlvbkRUTyB7XHJcbiAgJ2NyZWF0aW9uVGltZSc6IG51bWJlcjtcclxuICAnZGVzY3JpcHRpb24nOiBzdHJpbmc7XHJcbiAgJ2lkJzogc3RyaW5nO1xyXG4gICdtYXBGdW5jdGlvbic6IHN0cmluZztcclxuICAnbmFtZSc6IHN0cmluZztcclxuICAncXVlcnknOiBzdHJpbmc7XHJcbiAgJ3JlZHVjZUZ1bmN0aW9uJzogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQWdncmVnYXRpb25SZXNwb25zZSB7XHJcbiAgJ2lkJzogc3RyaW5nO1xyXG4gICdyZXN1bHQnOiBBcnJheTxhbnk+O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQmF0Y2hSZXNwb25zZSB7XHJcbiAgJ2JhdGNoSWQnOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDdXN0b21lckRUTyB7XHJcbiAgJ2FkZGl0aW9uYWxEYXRhJzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmc7IH07XHJcbiAgJ2FkZHJlc3MnOiBzdHJpbmc7XHJcbiAgJ2NvbXBhbnknOiBzdHJpbmc7XHJcbiAgJ2VtYWlsJzogc3RyaW5nO1xyXG4gICdpZCc6IHN0cmluZztcclxuICAnbmFtZSc6IHN0cmluZztcclxuICAncGhvbmUnOiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBFdmVudERUTyB7XHJcbiAgJ2FkZGl0aW9uYWxEYXRhJzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmc7IH07XHJcbiAgJ2Rlc2NyaXB0aW9uJzogc3RyaW5nO1xyXG4gICdwYWdlSWQnOiBzdHJpbmc7XHJcbiAgJ3RpbWVzdGFtcCc6IG51bWJlcjtcclxuICAndHlwZSc6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEZpZWxkRFRPIHtcclxuICAnZmllbGQnOiBzdHJpbmc7XHJcbiAgJ29wJzogc3RyaW5nO1xyXG4gICd0eXBlJzogc3RyaW5nO1xyXG4gICd2YWx1ZSc6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFBhZ2VEVE8ge1xyXG4gICdhZGRpdGlvbmFsRGF0YSc6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nOyB9O1xyXG4gICdmdWxsVXJsJzogc3RyaW5nO1xyXG4gICdpZCc6IHN0cmluZztcclxuICAnbmFtZSc6IHN0cmluZztcclxuICAndGltZVNwZW50JzogbnVtYmVyO1xyXG4gICd0aW1lc3RhbXAnOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBRdWVyeUZpZWxkc0RUTyB7XHJcbiAgJ2ZpZWxkcyc6IEFycmF5PEZpZWxkRFRPPjtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRlbmFudEluZm9EVE8ge1xyXG4gICdoZWFkZXJzJzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmc7IH07XHJcbiAgJ25vdGlmeVVybCc6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFRyYW5zYWN0aW9uRFRPIHtcclxuICAnYWRkaXRpb25hbERhdGEnOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZzsgfTtcclxuICAnY2F0ZWdvcnlJZCc6IHN0cmluZztcclxuICAnY3VzdG9tZXJJZCc6IHN0cmluZztcclxuICAnZW5kVGltZXN0YW1wJzogbnVtYmVyO1xyXG4gICdldmVudHMnOiBBcnJheTxFdmVudERUTz47XHJcbiAgJ2V4dGVybmFsU3lzdGVtSWQnOiBzdHJpbmc7XHJcbiAgJ2lkJzogc3RyaW5nO1xyXG4gICdpcEFkZHJlc3MnOiBzdHJpbmc7XHJcbiAgJ25hbWUnOiBzdHJpbmc7XHJcbiAgJ3BhZ2VzJzogQXJyYXk8UGFnZURUTz47XHJcbiAgJ3NvdXJjZSc6IHN0cmluZztcclxuICAnc3RhcnRUaW1lc3RhbXAnOiBudW1iZXI7XHJcbiAgJ3VzZXJBZ2VudCc6IHN0cmluZztcclxuICAndmFyaWFibGVzJzogQXJyYXk8VmFyaWFibGVEVE8+O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVmFyaWFibGUge1xyXG4gICdhZGRpdGlvbmFsRGF0YSc6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nOyB9O1xyXG4gICdkZWZhdWx0VmFsdWUnOiBzdHJpbmc7XHJcbiAgJ2lkJzogc3RyaW5nO1xyXG4gICdsYXN0VmFsdWUnOiBzdHJpbmc7XHJcbiAgJ25hbWUnOiBzdHJpbmc7XHJcbiAgJ3ZhbHVlcyc6IEFycmF5PFZhcmlhYmxlVmFsdWU+O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVmFyaWFibGVEVE8ge1xyXG4gICdhZGRpdGlvbmFsRGF0YSc6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nOyB9O1xyXG4gICdkZWZhdWx0VmFsdWUnOiBzdHJpbmc7XHJcbiAgJ2lkJzogc3RyaW5nO1xyXG4gICdsYXN0VmFsdWUnOiBzdHJpbmc7XHJcbiAgJ25hbWUnOiBzdHJpbmc7XHJcbiAgJ3ZhbHVlcyc6IEFycmF5PFZhcmlhYmxlVmFsdWU+O1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVmFyaWFibGVWYWx1ZSB7XHJcbiAgJ2VsZW1lbnQnOiBzdHJpbmc7XHJcbiAgJ3RpbWVzdGFtcCc6IG51bWJlcjtcclxuICAndmFsdWUnOiBzdHJpbmc7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEF1dGhlbnRpY2F0aW9uIHtcclxuICAvKipcclxuICAgKiBBcHBseSBhdXRoZW50aWNhdGlvbiBzZXR0aW5ncyB0byBoZWFkZXIgYW5kIHF1ZXJ5IHBhcmFtcy5cclxuICAgKi9cclxuICBhcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zKTogdm9pZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEh0dHBCYXNpY0F1dGggaW1wbGVtZW50cyBBdXRoZW50aWNhdGlvbiB7XHJcbiAgcHVibGljIHVzZXJuYW1lOiBzdHJpbmc7XHJcbiAgcHVibGljIHBhc3N3b3JkOiBzdHJpbmc7XHJcbiAgYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyk6IHZvaWQge1xyXG4gICAgcmVxdWVzdE9wdGlvbnMuYXV0aCA9IHtcclxuICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUsIHBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkXHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQXBpS2V5QXV0aCBpbXBsZW1lbnRzIEF1dGhlbnRpY2F0aW9uIHtcclxuICBwdWJsaWMgYXBpS2V5OiBzdHJpbmc7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbG9jYXRpb246IHN0cmluZywgcHJpdmF0ZSBwYXJhbU5hbWU6IHN0cmluZykge1xyXG4gIH1cclxuXHJcbiAgYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMubG9jYXRpb24gPT0gXCJxdWVyeVwiKSB7XHJcbiAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zLnFzKVt0aGlzLnBhcmFtTmFtZV0gPSB0aGlzLmFwaUtleTtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5sb2NhdGlvbiA9PSBcImhlYWRlclwiICYmIHJlcXVlc3RPcHRpb25zICYmIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMpIHtcclxuICAgICAgcmVxdWVzdE9wdGlvbnMuaGVhZGVyc1t0aGlzLnBhcmFtTmFtZV0gPSB0aGlzLmFwaUtleTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBPQXV0aCBpbXBsZW1lbnRzIEF1dGhlbnRpY2F0aW9uIHtcclxuICBwdWJsaWMgYWNjZXNzVG9rZW46IHN0cmluZztcclxuXHJcbiAgYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyk6IHZvaWQge1xyXG4gICAgaWYgKHJlcXVlc3RPcHRpb25zICYmIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMpIHtcclxuICAgICAgcmVxdWVzdE9wdGlvbnMuaGVhZGVyc1tcIkF1dGhvcml6YXRpb25cIl0gPSBcIkJlYXJlciBcIiArIHRoaXMuYWNjZXNzVG9rZW47XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVm9pZEF1dGggaW1wbGVtZW50cyBBdXRoZW50aWNhdGlvbiB7XHJcbiAgcHVibGljIHVzZXJuYW1lOiBzdHJpbmc7XHJcbiAgcHVibGljIHBhc3N3b3JkOiBzdHJpbmc7XHJcbiAgYXBwbHlUb1JlcXVlc3QoXzogcmVxdWVzdC5PcHRpb25zKTogdm9pZCB7XHJcbiAgICAvLyBEbyBub3RoaW5nXHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZW51bSBBZ2dyZWdhdGlvbmNvbnRyb2xsZXJBcGlBcGlLZXlzIHtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFnZ3JlZ2F0aW9uY29udHJvbGxlckFwaSB7XHJcbiAgcHJvdGVjdGVkIF9iYXNlUGF0aCA9IGRlZmF1bHRCYXNlUGF0aDtcclxuICBwcm90ZWN0ZWQgZGVmYXVsdEhlYWRlcnMgOiBhbnkgPSB7fTtcclxuICBwcm90ZWN0ZWQgX3VzZVF1ZXJ5c3RyaW5nIDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBwcm90ZWN0ZWQgYXV0aGVudGljYXRpb25zID0ge1xyXG4gICAgJ2RlZmF1bHQnOiA8QXV0aGVudGljYXRpb24+bmV3IFZvaWRBdXRoKCksXHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihiYXNlUGF0aD86IHN0cmluZyk7XHJcbiAgY29uc3RydWN0b3IoYmFzZVBhdGhPclVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkPzogc3RyaW5nLCBiYXNlUGF0aD86IHN0cmluZykge1xyXG4gICAgaWYgKHBhc3N3b3JkKSB7XHJcbiAgICAgIGlmIChiYXNlUGF0aCkge1xyXG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGJhc2VQYXRoT3JVc2VybmFtZSkge1xyXG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aE9yVXNlcm5hbWVcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0IHVzZVF1ZXJ5c3RyaW5nKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLl91c2VRdWVyeXN0cmluZyA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgc2V0IGJhc2VQYXRoKGJhc2VQYXRoOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuX2Jhc2VQYXRoID0gYmFzZVBhdGg7XHJcbiAgfVxyXG5cclxuICBnZXQgYmFzZVBhdGgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fYmFzZVBhdGg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0RGVmYXVsdEF1dGhlbnRpY2F0aW9uKGF1dGg6IEF1dGhlbnRpY2F0aW9uKSB7XHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0ID0gYXV0aDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXRBcGlLZXkoa2V5OiBBZ2dyZWdhdGlvbmNvbnRyb2xsZXJBcGlBcGlLZXlzLCB2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9uc1tBZ2dyZWdhdGlvbmNvbnRyb2xsZXJBcGlBcGlLZXlzW2tleV1dLmFwaUtleSA9IHZhbHVlO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBBZ2dyZWdhdGVzIHJhdyBkYXRhIGJ5IGdpdmVuIHF1ZXJ5LiAgIElmIHRoZSBxdWVyeSBpcyBpbnZhbGlkIEhUVFAgY29kZSA0MDYgaXMgcmV0dXJuZWRcclxuICAgKiBAc3VtbWFyeSBBZ2dyZWdhdGVzIHJhdyBkYXRhXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5IFJEUyBhcHBsaWNhdGlvbiBrZXlcclxuICAgKiBAcGFyYW0gYWdncmVnYXRpb25EVE8gQWdncmVnYXRpb25EVE8gaW5jbHVkZXMgdGhlIEFnZ3JlZ2F0aW9uIHF1ZXJ5LiAgIFRoZSBhZ2dyZWdhdGlvbiBxdWVyeSBqc29uIG11c3QgYmUgZXNjYXBlZC4gICBTZWUgaHR0cHM6Ly93d3cuZnJlZWZvcm1hdHRlci5jb20vanNvbi1lc2NhcGUuaHRtbCBmb3Igb25saW5lIGpzb24gZXNjYXBpbmcgIElsbGVnYWwga2V5d29yZHM6ICYjMzk7JHdoZXJlJiMzOTssICYjMzk7JGxvb2t1cCYjMzk7LCAmIzM5OyRvdXQmIzM5OywgJiMzOTskY29sbFN0YXRzJiMzOTssICYjMzk7JGluZGV4U3RhdHMmIzM5OywgJiMzOTtzdGFydFRpbWVzdGFtcCYjMzk7IGFuZCAmIzM5O2VuZFRpbWVzdGFtcCYjMzk7IGluICRtYXRjaCBzdGFnZVxyXG4gICAqIEBwYXJhbSB0ZW5hbnRJZCBUZW5hbnQgSWRcclxuICAgKiBAcGFyYW0gZW52IFRlbmFudCBlbnZpcm9ubWVudCBuYW1lIChJbnRlcmFjdCBtdWx0aS1lbXZpcm9ubWVudClcclxuICAgKi9cclxuICBwdWJsaWMgYWdncmVnYXRlIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBhZ2dyZWdhdGlvbkRUTzogQWdncmVnYXRpb25EVE8sIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFnZ3JlZ2F0aW9uQ3JlYXRlUmVzcG9uc2U7ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hZ2dyZWdhdGlvbic7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGUuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYWdncmVnYXRpb25EVE8nIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFnZ3JlZ2F0aW9uRFRPID09PSBudWxsIHx8IGFnZ3JlZ2F0aW9uRFRPID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25EVE8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGUuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGUuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgICBib2R5OiBhZ2dyZWdhdGlvbkRUTyxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XHJcblxyXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xyXG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcclxuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQWdncmVnYXRpb25DcmVhdGVSZXNwb25zZTsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXR1cm5zIGFnZ3JlZ2F0ZWQgZGF0YSBieSBnaXZlbiBxdWVyeS4gICBJZiB0aGUgcXVlcnkgaXMgaW52YWxpZCBIVFRQIGNvZGUgNDA2IGlzIHJldHVybmVkXHJcbiAgICogQHN1bW1hcnkgUmV0cmlldmVzIGFnZ3JlZ2F0ZWQgZGF0YVxyXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleSBSRFMgYXBwbGljYXRpb24ga2V5XHJcbiAgICogQHBhcmFtIHF1ZXJ5IEFnZ3JlZ2F0aW9uIHF1ZXJ5LiAgVGhlIGFnZ3JlZ2F0aW9uIHF1ZXJ5IGpzb24gbXVzdCBiZSBlc2NhcGVkLiAgIFNlZSBodHRwczovL3d3dy5mcmVlZm9ybWF0dGVyLmNvbS9qc29uLWVzY2FwZS5odG1sIGZvciBvbmxpbmUganNvbiBlc2NhcGluZyAgSWxsZWdhbCBrZXl3b3JkczogJiMzOTskd2hlcmUmIzM5OywgJiMzOTskbG9va3VwJiMzOTssICYjMzk7JG91dCYjMzk7LCAmIzM5OyRjb2xsU3RhdHMmIzM5OywgJiMzOTskaW5kZXhTdGF0cyYjMzk7XHJcbiAgICogQHBhcmFtIGFnZ3JlZ2F0aW9uSWQgQWdncmVnYXRpb24gZGVmaW5pdGlvbiBpZFxyXG4gICAqIEBwYXJhbSB0ZW5hbnRJZCBUZW5hbnQgSWRcclxuICAgKiBAcGFyYW0gZW52IFRlbmFudCBlbnZpcm9ubWVudCBuYW1lIChJbnRlcmFjdCBtdWx0aS1lbXZpcm9ubWVudClcclxuICAgKi9cclxuICBwdWJsaWMgYWdncmVnYXRpb25SZXRyaWV2ZSAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgcXVlcnk6IE1vZGVsU3RyaW5nLCBhZ2dyZWdhdGlvbklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFycmF5PGFueT47ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9hZ2dyZWdhdGlvbi9yZXN1bHRzL3thZ2dyZWdhdGlvbklkfSdcclxuICAgICAgLnJlcGxhY2UoJ3snICsgJ2FnZ3JlZ2F0aW9uSWQnICsgJ30nLCBTdHJpbmcoYWdncmVnYXRpb25JZCkpO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgYWdncmVnYXRpb25SZXRyaWV2ZS4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdxdWVyeScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAocXVlcnkgPT09IG51bGwgfHwgcXVlcnkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBxdWVyeSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGFnZ3JlZ2F0aW9uUmV0cmlldmUuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYWdncmVnYXRpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYWdncmVnYXRpb25JZCA9PT0gbnVsbCB8fCBhZ2dyZWdhdGlvbklkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGFnZ3JlZ2F0aW9uUmV0cmlldmUuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGlvblJldHJpZXZlLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgICAgYm9keTogcXVlcnksXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFycmF5PGFueT47ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogRm9yIHRlc3RpbmcgdGhlIGFnZ3JlZ2F0aW9uIHF1ZXJ5IGJlZm9yZSBjYWxsaW5nIHRoZSBhZ2dyZWdhdGUgQVBJLiAgV2lsbCBydW4gdGhlIHF1ZXJ5IG9uIHRoZSBwYXN0IDQgaG91cnMgYW5kIHdpbGwgcmV0dXJuIHRoZSByZXN1bHRzIG9mIHRoZSBhZ2dyZWdhdGlvbi4gIElmIHRoZSBxdWVyeSBpcyBpbnZhbGlkIEhUVFAgY29kZSA0MDYgaXMgcmV0dXJuZWRcclxuICAgKiBAc3VtbWFyeSBUZXN0cyBhZ2dyZWdhdGlvbiBxdWVyeSBvZiByYXcgZGF0YVxyXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleSBSRFMgYXBwbGljYXRpb24ga2V5XHJcbiAgICogQHBhcmFtIHF1ZXJ5IEFnZ3JlZ2F0aW9uIHRlc3QgcXVlcnkuICBUaGUgYWdncmVnYXRpb24gcXVlcnkganNvbiBtdXN0IGJlIGVzY2FwZWQuICAgU2VlIGh0dHBzOi8vd3d3LmZyZWVmb3JtYXR0ZXIuY29tL2pzb24tZXNjYXBlLmh0bWwgZm9yIG9ubGluZSBqc29uIGVzY2FwaW5nICBJbGxlZ2FsIGtleXdvcmRzOiAmIzM5OyR3aGVyZSYjMzk7LCAmIzM5OyRsb29rdXAmIzM5OywgJiMzOTskb3V0JiMzOTssICYjMzk7JGNvbGxTdGF0cyYjMzk7LCAmIzM5OyRpbmRleFN0YXRzJiMzOTssICYjMzk7c3RhcnRUaW1lc3RhbXAmIzM5OyBhbmQgJiMzOTtlbmRUaW1lc3RhbXAmIzM5OyBpbiAkbWF0Y2ggc3RhZ2VcclxuICAgKiBAcGFyYW0gdGVuYW50SWQgVGVuYW50IElkXHJcbiAgICogQHBhcmFtIGVudiBUZW5hbnQgZW52aXJvbm1lbnQgbmFtZSAoSW50ZXJhY3QgbXVsdGktZW12aXJvbm1lbnQpXHJcbiAgICovXHJcbiAgcHVibGljIGFnZ3JlZ2F0aW9uVGVzdCAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgcXVlcnk6IE1vZGVsU3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBZ2dyZWdhdGlvblJlc3BvbnNlOyAgfT4ge1xyXG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvYWdncmVnYXRpb24vdGVzdCc7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGlvblRlc3QuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAncXVlcnknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHF1ZXJ5ID09PSBudWxsIHx8IHF1ZXJ5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgcXVlcnkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGlvblRlc3QuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBhZ2dyZWdhdGlvblRlc3QuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgICBib2R5OiBxdWVyeSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XHJcblxyXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xyXG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcclxuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQWdncmVnYXRpb25SZXNwb25zZTsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBEZWxldGVzIGFnZ3JlZ2F0aW9uIGJ5IGlkLCBpZiB0aGUgdGhlIGFnZ3JlZ2F0aW9uIG5vdCBleGlzdHMgSFRUUCBjb2RlIDQwNCByZXR1cm5lZFxyXG4gICAqIEBzdW1tYXJ5IERlbGV0ZXMgYSBzcGVjaWZpYyBhZ2dyZWdhdGlvbiBpbiBSRFNcclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcclxuICAgKiBAcGFyYW0gYWdncmVnYXRpb25JZCBUaGUgYWdncmVnYXRpb24gSURcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gZW52XHJcbiAgICovXHJcbiAgcHVibGljIGRlbGV0ZUFnZ3JlZ2F0aW9uIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBhZ2dyZWdhdGlvbklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IHN0cmluZzsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uL3thZ2dyZWdhdGlvbklkfSdcclxuICAgICAgLnJlcGxhY2UoJ3snICsgJ2FnZ3JlZ2F0aW9uSWQnICsgJ30nLCBTdHJpbmcoYWdncmVnYXRpb25JZCkpO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZGVsZXRlQWdncmVnYXRpb24uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYWdncmVnYXRpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYWdncmVnYXRpb25JZCA9PT0gbnVsbCB8fCBhZ2dyZWdhdGlvbklkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGRlbGV0ZUFnZ3JlZ2F0aW9uLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZGVsZXRlQWdncmVnYXRpb24uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxyXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXHJcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxyXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXHJcbiAgICAgIGpzb246IHRydWUsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IHN0cmluZzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBSZXR1cm5zIGFnZ3JlZ2F0ZWQgZGF0YSBieSBnaXZlbiBxdWVyeS5cclxuICAgKiBAc3VtbWFyeSBSZXRyaWV2ZXMgYWdncmVnYXRlZCBkYXRhIGJ5IGZpbmQgcXVlcnlcclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXkgUkRTIGFwcGxpY2F0aW9uIGtleVxyXG4gICAqIEBwYXJhbSBxdWVyeUZpZWxkc0RUTyBGaWVsZHMgdG8gdXNlIGluIHRoZSBmaW5kIHF1ZXJ5LlxyXG4gICAqIEBwYXJhbSBhZ2dyZWdhdGlvbklkIEFnZ3JlZ2F0aW9uIGRlZmluaXRpb24gaWRcclxuICAgKiBAcGFyYW0gdGVuYW50SWQgVGVuYW50IElkXHJcbiAgICogQHBhcmFtIGVudiBUZW5hbnQgZW52aXJvbm1lbnQgbmFtZSAoSW50ZXJhY3QgbXVsdGktZW12aXJvbm1lbnQpXHJcbiAgICovXHJcbiAgcHVibGljIGZpbmRRdWVyeVJldHJpZXZlIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBxdWVyeUZpZWxkc0RUTzogUXVlcnlGaWVsZHNEVE8sIGFnZ3JlZ2F0aW9uSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQXJyYXk8YW55PjsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uL3Jlc3VsdHMvc2ltcGxlL3thZ2dyZWdhdGlvbklkfSdcclxuICAgICAgLnJlcGxhY2UoJ3snICsgJ2FnZ3JlZ2F0aW9uSWQnICsgJ30nLCBTdHJpbmcoYWdncmVnYXRpb25JZCkpO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZmluZFF1ZXJ5UmV0cmlldmUuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAncXVlcnlGaWVsZHNEVE8nIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHF1ZXJ5RmllbGRzRFRPID09PSBudWxsIHx8IHF1ZXJ5RmllbGRzRFRPID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgcXVlcnlGaWVsZHNEVE8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBmaW5kUXVlcnlSZXRyaWV2ZS4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhZ2dyZWdhdGlvbklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhZ2dyZWdhdGlvbklkID09PSBudWxsIHx8IGFnZ3JlZ2F0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhZ2dyZWdhdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZmluZFF1ZXJ5UmV0cmlldmUuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBmaW5kUXVlcnlSZXRyaWV2ZS4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxyXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXHJcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxyXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXHJcbiAgICAgIGpzb246IHRydWUsXHJcbiAgICAgIGJvZHk6IHF1ZXJ5RmllbGRzRFRPLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBcnJheTxhbnk+OyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEdldCBsaXN0IG9mIGFnZ3JlZ2F0aW9ucyBjcmVhdGVkIGZvciB0ZW5hbnRcclxuICAgKiBAc3VtbWFyeSBHZXRzIGxpc3Qgb2YgYWdncmVnYXRpb25zXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRBZ2dyZWdhdGlvbnMgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEFycmF5PEFnZ3JlZ2F0aW9uRFRPPjsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uJztcclxuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xyXG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xyXG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xyXG5cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldEFnZ3JlZ2F0aW9ucy4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldEFnZ3JlZ2F0aW9ucy4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XHJcblxyXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xyXG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcclxuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQXJyYXk8QWdncmVnYXRpb25EVE8+OyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgYWdncmVnYXRpb24gYnkgaWQsIGlmIHRoZSB0aGUgYWdncmVnYXRpb24gbm90IGV4aXN0cyBIVFRQIGNvZGUgNDA0IHJldHVybmVkXHJcbiAgICogQHN1bW1hcnkgVXBkYXRlcyBhIHNwZWNpZmljIGFnZ3JlZ2F0aW9uIGluIFJEU1xyXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxyXG4gICAqIEBwYXJhbSBhZ2dyZWdhdGlvbklkIFRoZSBhZ2dyZWdhdGlvbiBJRFxyXG4gICAqIEBwYXJhbSBhZ2dyZWdhdGlvbkRUTyBBZ2dyZWdhdGlvbkRUTyBpbmNsdWRlcyB0aGUgQWdncmVnYXRpb24gcXVlcnkuICAgVGhlIGFnZ3JlZ2F0aW9uIHF1ZXJ5IGpzb24gbXVzdCBiZSBlc2NhcGVkLiAgIFNlZSBodHRwczovL3d3dy5mcmVlZm9ybWF0dGVyLmNvbS9qc29uLWVzY2FwZS5odG1sIGZvciBvbmxpbmUganNvbiBlc2NhcGluZyAgSWxsZWdhbCBrZXl3b3JkczogJiMzOTskd2hlcmUmIzM5OywgJiMzOTskbG9va3VwJiMzOTssICYjMzk7JG91dCYjMzk7LCAmIzM5OyRjb2xsU3RhdHMmIzM5OywgJiMzOTskaW5kZXhTdGF0cyYjMzk7LCAmIzM5O3N0YXJ0VGltZXN0YW1wJiMzOTsgYW5kICYjMzk7ZW5kVGltZXN0YW1wJiMzOTsgaW4gJG1hdGNoIHN0YWdlXHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1cGRhdGVBZ2dyZWdhdGlvbiAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgYWdncmVnYXRpb25JZDogc3RyaW5nLCBhZ2dyZWdhdGlvbkRUTzogQWdncmVnYXRpb25EVE8sIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IHN0cmluZzsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2FnZ3JlZ2F0aW9uL3thZ2dyZWdhdGlvbklkfSdcclxuICAgICAgLnJlcGxhY2UoJ3snICsgJ2FnZ3JlZ2F0aW9uSWQnICsgJ30nLCBTdHJpbmcoYWdncmVnYXRpb25JZCkpO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlQWdncmVnYXRpb24uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYWdncmVnYXRpb25JZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYWdncmVnYXRpb25JZCA9PT0gbnVsbCB8fCBhZ2dyZWdhdGlvbklkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYWdncmVnYXRpb25JZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZUFnZ3JlZ2F0aW9uLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FnZ3JlZ2F0aW9uRFRPJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhZ2dyZWdhdGlvbkRUTyA9PT0gbnVsbCB8fCBhZ2dyZWdhdGlvbkRUTyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFnZ3JlZ2F0aW9uRFRPIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlQWdncmVnYXRpb24uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVBZ2dyZWdhdGlvbi4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgICAgYm9keTogYWdncmVnYXRpb25EVE8sXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IHN0cmluZzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5leHBvcnQgZW51bSBDdXN0b21lcmNvbnRyb2xsZXJBcGlBcGlLZXlzIHtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEN1c3RvbWVyY29udHJvbGxlckFwaSB7XHJcbiAgcHJvdGVjdGVkIF9iYXNlUGF0aCA9IGRlZmF1bHRCYXNlUGF0aDtcclxuICBwcm90ZWN0ZWQgZGVmYXVsdEhlYWRlcnMgOiBhbnkgPSB7fTtcclxuICBwcm90ZWN0ZWQgX3VzZVF1ZXJ5c3RyaW5nIDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBwcm90ZWN0ZWQgYXV0aGVudGljYXRpb25zID0ge1xyXG4gICAgJ2RlZmF1bHQnOiA8QXV0aGVudGljYXRpb24+bmV3IFZvaWRBdXRoKCksXHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihiYXNlUGF0aD86IHN0cmluZyk7XHJcbiAgY29uc3RydWN0b3IoYmFzZVBhdGhPclVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkPzogc3RyaW5nLCBiYXNlUGF0aD86IHN0cmluZykge1xyXG4gICAgaWYgKHBhc3N3b3JkKSB7XHJcbiAgICAgIGlmIChiYXNlUGF0aCkge1xyXG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGJhc2VQYXRoT3JVc2VybmFtZSkge1xyXG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aE9yVXNlcm5hbWVcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0IHVzZVF1ZXJ5c3RyaW5nKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLl91c2VRdWVyeXN0cmluZyA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgc2V0IGJhc2VQYXRoKGJhc2VQYXRoOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuX2Jhc2VQYXRoID0gYmFzZVBhdGg7XHJcbiAgfVxyXG5cclxuICBnZXQgYmFzZVBhdGgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fYmFzZVBhdGg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0RGVmYXVsdEF1dGhlbnRpY2F0aW9uKGF1dGg6IEF1dGhlbnRpY2F0aW9uKSB7XHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0ID0gYXV0aDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXRBcGlLZXkoa2V5OiBDdXN0b21lcmNvbnRyb2xsZXJBcGlBcGlLZXlzLCB2YWx1ZTogc3RyaW5nKSB7XHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9uc1tDdXN0b21lcmNvbnRyb2xsZXJBcGlBcGlLZXlzW2tleV1dLmFwaUtleSA9IHZhbHVlO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBDcmVhdGVzIHRoZSBjdXN0b21lciBpbiBSRFMgZnJvbSB0aGUgQ3VzdG9tZXJEVE8gaW4gdGhlIGJvZHkgYW5kIHJldHVybiBIVFRQIGNvZGUgMjAxIChjcmVhdGVkKVxyXG4gICAqIEBzdW1tYXJ5IENyZWF0ZXMgY3VzdG9tZXIgaW4gUkRTXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIGN1c3RvbWVyRHRvIFRoZSBjdXN0b21lciBib2R5XHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjcmVhdGVDdXN0b21lciAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgY3VzdG9tZXJEdG86IEN1c3RvbWVyRFRPLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBDdXN0b21lckRUTzsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2N1c3RvbWVycyc7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVDdXN0b21lci4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdjdXN0b21lckR0bycgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoY3VzdG9tZXJEdG8gPT09IG51bGwgfHwgY3VzdG9tZXJEdG8gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBjdXN0b21lckR0byB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZUN1c3RvbWVyLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlQ3VzdG9tZXIuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgICBib2R5OiBjdXN0b21lckR0byxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XHJcblxyXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xyXG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcclxuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQ3VzdG9tZXJEVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogRGVsZXRlcyBjdXN0b21lciBieSBpZCwgaWYgdGhlIHRoZSBjdXN0b21lciBub3QgZXhpc3RzIEhUVFAgY29kZSA0MDQgcmV0dXJuZWRcclxuICAgKiBAc3VtbWFyeSBEZWxldGVzIGEgY3VzdG9tZXIgaW4gUkRTXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIGN1c3RvbWVySWQgVGhlIGN1c3RvbWVyIElEXHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyBkZWxldGVDdXN0b21lciAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgY3VzdG9tZXJJZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBzdHJpbmc7ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy9jdXN0b21lcnMve2N1c3RvbWVySWR9J1xyXG4gICAgICAucmVwbGFjZSgneycgKyAnY3VzdG9tZXJJZCcgKyAnfScsIFN0cmluZyhjdXN0b21lcklkKSk7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBkZWxldGVDdXN0b21lci4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdjdXN0b21lcklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChjdXN0b21lcklkID09PSBudWxsIHx8IGN1c3RvbWVySWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBjdXN0b21lcklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZGVsZXRlQ3VzdG9tZXIuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBkZWxldGVDdXN0b21lci4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ0RFTEVURScsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XHJcblxyXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xyXG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcclxuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogc3RyaW5nOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFJlYWRzIHRoZSBjdXN0b21lciBmcm9tIFJEUyBieSBjdXN0b21lciBpZCwgaWYgdGhlIGN1c3RvbWVyIG5vdCBleGlzdHMgaW4gUkRTLCBIVFRQIGVycm9yIDQwNCByZXR1cm5lZFxyXG4gICAqIEBzdW1tYXJ5IEdldHMgc3BlY2lmaWMgY3VzdG9tZXIgZnJvbSBSRFMgYnkgY3VzdG9tZXIgaWRcclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcclxuICAgKiBAcGFyYW0gY3VzdG9tZXJJZCBUaGUgY3VzdG9tZXIgSURcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gZW52XHJcbiAgICovXHJcbiAgcHVibGljIHJlYWRDdXN0b21lciAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgY3VzdG9tZXJJZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBDdXN0b21lckRUTzsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL2N1c3RvbWVycy97Y3VzdG9tZXJJZH0nXHJcbiAgICAgIC5yZXBsYWNlKCd7JyArICdjdXN0b21lcklkJyArICd9JywgU3RyaW5nKGN1c3RvbWVySWQpKTtcclxuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xyXG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xyXG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xyXG5cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHJlYWRDdXN0b21lci4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdjdXN0b21lcklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChjdXN0b21lcklkID09PSBudWxsIHx8IGN1c3RvbWVySWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBjdXN0b21lcklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgcmVhZEN1c3RvbWVyLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgcmVhZEN1c3RvbWVyLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBDdXN0b21lckRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBVc2luZyBjdXN0b21lciBpZCBhbmQgQ3VzdG9tZXJEVE8gd2lsbCB1cGRhdGUgdGhlIHNwY2lmaWMgY3VzdG9tZXIgYW5kIHJldHVybiBIVFRQIGNvZGUgMjAwIGlmIHN1Y2Nlc3Mgb3IgaWYgdGhlIGN1c3RvbWVyIG5vdCBmb3VuZCBIVFRQIGNvZGUgNDA0XHJcbiAgICogQHN1bW1hcnkgVXBkYXRlcyBjdXN0b21lciBpbiBSRFNcclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcclxuICAgKiBAcGFyYW0gY3VzdG9tZXJEdG8gVGhlIGN1c3RvbWVyIGJvZHlcclxuICAgKiBAcGFyYW0gY3VzdG9tZXJJZCBUaGUgY3VzdG9tZXIgSURcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gZW52XHJcbiAgICovXHJcbiAgcHVibGljIHVwZGF0ZUN1c3RvbWVyIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCBjdXN0b21lckR0bzogc3RyaW5nLCBjdXN0b21lcklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEN1c3RvbWVyRFRPOyAgfT4ge1xyXG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvY3VzdG9tZXJzL3tjdXN0b21lcklkfSdcclxuICAgICAgLnJlcGxhY2UoJ3snICsgJ2N1c3RvbWVySWQnICsgJ30nLCBTdHJpbmcoY3VzdG9tZXJJZCkpO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlQ3VzdG9tZXIuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnY3VzdG9tZXJEdG8nIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGN1c3RvbWVyRHRvID09PSBudWxsIHx8IGN1c3RvbWVyRHRvID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgY3VzdG9tZXJEdG8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVDdXN0b21lci4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdjdXN0b21lcklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChjdXN0b21lcklkID09PSBudWxsIHx8IGN1c3RvbWVySWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBjdXN0b21lcklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlQ3VzdG9tZXIuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVDdXN0b21lci4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgICAgYm9keTogY3VzdG9tZXJEdG8sXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEN1c3RvbWVyRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbmV4cG9ydCBlbnVtIFRlbmFudGluZm9jb250cm9sbGVyQXBpQXBpS2V5cyB7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUZW5hbnRpbmZvY29udHJvbGxlckFwaSB7XHJcbiAgcHJvdGVjdGVkIF9iYXNlUGF0aCA9IGRlZmF1bHRCYXNlUGF0aDtcclxuICBwcm90ZWN0ZWQgZGVmYXVsdEhlYWRlcnMgOiBhbnkgPSB7fTtcclxuICBwcm90ZWN0ZWQgX3VzZVF1ZXJ5c3RyaW5nIDogYm9vbGVhbiA9IGZhbHNlO1xyXG5cclxuICBwcm90ZWN0ZWQgYXV0aGVudGljYXRpb25zID0ge1xyXG4gICAgJ2RlZmF1bHQnOiA8QXV0aGVudGljYXRpb24+bmV3IFZvaWRBdXRoKCksXHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihiYXNlUGF0aD86IHN0cmluZyk7XHJcbiAgY29uc3RydWN0b3IoYmFzZVBhdGhPclVzZXJuYW1lOiBzdHJpbmcsIHBhc3N3b3JkPzogc3RyaW5nLCBiYXNlUGF0aD86IHN0cmluZykge1xyXG4gICAgaWYgKHBhc3N3b3JkKSB7XHJcbiAgICAgIGlmIChiYXNlUGF0aCkge1xyXG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKGJhc2VQYXRoT3JVc2VybmFtZSkge1xyXG4gICAgICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aE9yVXNlcm5hbWVcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0IHVzZVF1ZXJ5c3RyaW5nKHZhbHVlOiBib29sZWFuKSB7XHJcbiAgICB0aGlzLl91c2VRdWVyeXN0cmluZyA9IHZhbHVlO1xyXG4gIH1cclxuXHJcbiAgc2V0IGJhc2VQYXRoKGJhc2VQYXRoOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuX2Jhc2VQYXRoID0gYmFzZVBhdGg7XHJcbiAgfVxyXG5cclxuICBnZXQgYmFzZVBhdGgoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fYmFzZVBhdGg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0RGVmYXVsdEF1dGhlbnRpY2F0aW9uKGF1dGg6IEF1dGhlbnRpY2F0aW9uKSB7XHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0ID0gYXV0aDtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzZXRBcGlLZXkoa2V5OiBUZW5hbnRpbmZvY29udHJvbGxlckFwaUFwaUtleXMsIHZhbHVlOiBzdHJpbmcpIHtcclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zW1RlbmFudGluZm9jb250cm9sbGVyQXBpQXBpS2V5c1trZXldXS5hcGlLZXkgPSB2YWx1ZTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlcyB0ZW5hbnQgaW5mbyBpbiBSRFMsIHRoZSB0ZW5hbnQgaW5mbyBjb250YWlucyB0aGUgY29uZmlndXJhdGlvbiBvZiB0aGUgdGVuYW50LCBSRFMgd2lsbCB1c2UgdGhpcyBjb25maWd1cmF0aW9uIHRvIFBPU1QgYSBub3RpZmljYXRpb24gYWZ0ZXIgYmF0Y2ggcmV0cmlldmUgcHJvY2Vzc2luZyBjb21wbGV0ZWQgdG8gbm90aWZ5VXJsIGFuZCByZWxldmFudCBodHRwIGhlYWRlcnMuXHJcbiAgICogQHN1bW1hcnkgQ3JlYXRlcyB0ZW5hbnQgaW5mbyBpbiBSRFNcclxuICAgKiBAcGFyYW0gdGVuYW50SW5mb0R0byB0ZW5hbnRJbmZvRHRvXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjcmVhdGVUZW5hbnRJbmZvICh0ZW5hbnRJbmZvRHRvOiBUZW5hbnRJbmZvRFRPLCBhcHBsaWNhdGlvbktleTogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUZW5hbnRJbmZvRFRPOyAgfT4ge1xyXG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdGVuYW50SW5mbyc7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SW5mb0R0bycgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SW5mb0R0byA9PT0gbnVsbCB8fCB0ZW5hbnRJbmZvRHRvID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SW5mb0R0byB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZVRlbmFudEluZm8uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVUZW5hbnRJbmZvLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVGVuYW50SW5mby4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxyXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXHJcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxyXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXHJcbiAgICAgIGpzb246IHRydWUsXHJcbiAgICAgIGJvZHk6IHRlbmFudEluZm9EdG8sXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRlbmFudEluZm9EVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogUmVhZHMgdGhlIHRlbmFudCBpbmZvIGZyb20gUkRTLCBIVFRQIGNvZGUgNDA0IHdpbGwgYmUgcmV0dXJuZWQgaWYgdGhlIHRlbmFudCBoYXMgbm8gaW5mbyBpbiBSRFNcclxuICAgKiBAc3VtbWFyeSBSZWFkcyB0aGUgdGVuYW50IGluZm8gZnJvbSBSRFNcclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gZW52XHJcbiAgICovXHJcbiAgcHVibGljIHJlYWRUZW5hbnRJbmZvIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUZW5hbnRJbmZvRFRPOyAgfT4ge1xyXG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdGVuYW50SW5mbyc7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyByZWFkVGVuYW50SW5mby4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHJlYWRUZW5hbnRJbmZvLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUZW5hbnRJbmZvRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZXMgYSB0ZW5hbnQgaW5mbyBieSBpZCBhbmQgVGVuYW50SW5mb0RUT1xyXG4gICAqIEBzdW1tYXJ5IFVwZGF0ZXMgdGVuYW50IGluZm8gaW4gUkRTXHJcbiAgICogQHBhcmFtIHRlbmFudEluZm9EVE8gdGVuYW50SW5mb0RUT1xyXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxyXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxyXG4gICAqIEBwYXJhbSBlbnZcclxuICAgKi9cclxuICBwdWJsaWMgdXBkYXRlVGVuYW50SW5mbyAodGVuYW50SW5mb0RUTzogVGVuYW50SW5mb0RUTywgYXBwbGljYXRpb25LZXk6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVGVuYW50SW5mb0RUTzsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RlbmFudEluZm8nO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudEluZm9EVE8nIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudEluZm9EVE8gPT09IG51bGwgfHwgdGVuYW50SW5mb0RUTyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudEluZm9EVE8gd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVUZW5hbnRJbmZvLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlVGVuYW50SW5mby4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHVwZGF0ZVRlbmFudEluZm8uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxyXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXHJcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxyXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXHJcbiAgICAgIGpzb246IHRydWUsXHJcbiAgICAgIGJvZHk6IHRlbmFudEluZm9EVE8sXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRlbmFudEluZm9EVE87ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuZXhwb3J0IGVudW0gVHJhbnNhY3Rpb25jb250cm9sbGVyQXBpQXBpS2V5cyB7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBUcmFuc2FjdGlvbmNvbnRyb2xsZXJBcGkge1xyXG4gIHByb3RlY3RlZCBfYmFzZVBhdGggPSBkZWZhdWx0QmFzZVBhdGg7XHJcbiAgcHJvdGVjdGVkIGRlZmF1bHRIZWFkZXJzIDogYW55ID0ge307XHJcbiAgcHJvdGVjdGVkIF91c2VRdWVyeXN0cmluZyA6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgcHJvdGVjdGVkIGF1dGhlbnRpY2F0aW9ucyA9IHtcclxuICAgICdkZWZhdWx0JzogPEF1dGhlbnRpY2F0aW9uPm5ldyBWb2lkQXV0aCgpLFxyXG4gIH1cclxuXHJcbiAgY29uc3RydWN0b3IoYmFzZVBhdGg/OiBzdHJpbmcpO1xyXG4gIGNvbnN0cnVjdG9yKGJhc2VQYXRoT3JVc2VybmFtZTogc3RyaW5nLCBwYXNzd29yZD86IHN0cmluZywgYmFzZVBhdGg/OiBzdHJpbmcpIHtcclxuICAgIGlmIChwYXNzd29yZCkge1xyXG4gICAgICBpZiAoYmFzZVBhdGgpIHtcclxuICAgICAgICB0aGlzLmJhc2VQYXRoID0gYmFzZVBhdGg7XHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChiYXNlUGF0aE9yVXNlcm5hbWUpIHtcclxuICAgICAgICB0aGlzLmJhc2VQYXRoID0gYmFzZVBhdGhPclVzZXJuYW1lXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldCB1c2VRdWVyeXN0cmluZyh2YWx1ZTogYm9vbGVhbikge1xyXG4gICAgdGhpcy5fdXNlUXVlcnlzdHJpbmcgPSB2YWx1ZTtcclxuICB9XHJcblxyXG4gIHNldCBiYXNlUGF0aChiYXNlUGF0aDogc3RyaW5nKSB7XHJcbiAgICB0aGlzLl9iYXNlUGF0aCA9IGJhc2VQYXRoO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGJhc2VQYXRoKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2Jhc2VQYXRoO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIHNldERlZmF1bHRBdXRoZW50aWNhdGlvbihhdXRoOiBBdXRoZW50aWNhdGlvbikge1xyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdCA9IGF1dGg7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc2V0QXBpS2V5KGtleTogVHJhbnNhY3Rpb25jb250cm9sbGVyQXBpQXBpS2V5cywgdmFsdWU6IHN0cmluZykge1xyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnNbVHJhbnNhY3Rpb25jb250cm9sbGVyQXBpQXBpS2V5c1trZXldXS5hcGlLZXkgPSB2YWx1ZTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogQWRkcyBhZGR0aW9uYWwgZGF0YSB0byBhbiBleGlzdGluZyBUcmFuc2FjdGlvblxyXG4gICAqIEBzdW1tYXJ5IEFkZHMgYWRkaXRpb25hbCBkYXRhIHRvIFRyYW5zYWN0aW9uXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIGFkZGl0aW9uYWxEYXRhIE1hcCBvZiBhZGRpdGlvbmFsIGRhdGFcclxuICAgKiBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRFxyXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxyXG4gICAqIEBwYXJhbSBlbnZcclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlQWRkaXRpb25hbERhdGEgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIGFkZGl0aW9uYWxEYXRhOiBhbnksIHRyYW5zYWN0aW9uSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMve3RyYW5zYWN0aW9uSWR9L2FkZGl0aW9uYWxEYXRhJ1xyXG4gICAgICAucmVwbGFjZSgneycgKyAndHJhbnNhY3Rpb25JZCcgKyAnfScsIFN0cmluZyh0cmFuc2FjdGlvbklkKSk7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVBZGRpdGlvbmFsRGF0YS4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhZGRpdGlvbmFsRGF0YScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYWRkaXRpb25hbERhdGEgPT09IG51bGwgfHwgYWRkaXRpb25hbERhdGEgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhZGRpdGlvbmFsRGF0YSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZUFkZGl0aW9uYWxEYXRhLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RyYW5zYWN0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgdHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRyYW5zYWN0aW9uSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVBZGRpdGlvbmFsRGF0YS4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZUFkZGl0aW9uYWxEYXRhLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgICAgYm9keTogYWRkaXRpb25hbERhdGEsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEdldHMgYSBsaXN0IG9mIGV2ZW50cyBhbmQgYWRkIHRoZW0gdG8gYW4gZXhpc3RpbmcgVHJhbnNhY3Rpb24sIGlmIHRoZSBUcmFuc2FjdGlvbiBub3QgZXhpc3RzIHdpbGwgcmV0dXJuIEhUVFAgY29kZSA0MDRcclxuICAgKiBAc3VtbWFyeSBDcmVhdGVzIGV2ZW50cyBmb3Igc3BlY2lmaWMgdHJhbnNhY3Rpb25cclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcclxuICAgKiBAcGFyYW0gZXZlbnRzIExpc3Qgb2YgZXZlbnRzXHJcbiAgICogQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSURcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gZW52XHJcbiAgICovXHJcbiAgcHVibGljIGNyZWF0ZUV2ZW50cyAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgZXZlbnRzOiBFdmVudERUTywgdHJhbnNhY3Rpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RyYW5zYWN0aW9ucy97dHJhbnNhY3Rpb25JZH0vZXZlbnRzJ1xyXG4gICAgICAucmVwbGFjZSgneycgKyAndHJhbnNhY3Rpb25JZCcgKyAnfScsIFN0cmluZyh0cmFuc2FjdGlvbklkKSk7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVFdmVudHMuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnZXZlbnRzJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChldmVudHMgPT09IG51bGwgfHwgZXZlbnRzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgZXZlbnRzIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlRXZlbnRzLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RyYW5zYWN0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgdHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRyYW5zYWN0aW9uSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVFdmVudHMuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVFdmVudHMuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgICBib2R5OiBldmVudHMsXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEdldHMgYSBsaXN0IG9mIHBhZ2VzIGFuZCBhZGQgdGhlbSB0byBhbiBleGlzdGluZyBUcmFuc2FjdGlvbiwgaWYgdGhlIFRyYW5zYWN0aW9uIG5vdCBleGlzdHMgd2lsbCByZXR1cm4gSFRUUCBjb2RlIDQwNFxyXG4gICAqIEBzdW1tYXJ5IENyZWF0ZXMgcGFnZXMgZm9yIHNwZWNpZmljIHRyYW5zYWN0aW9uXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIHBhZ2VzIExpc3Qgb2YgcGFnZXNcclxuICAgKiBAcGFyYW0gdHJhbnNhY3Rpb25JZCBUcmFuc2FjdGlvbiBJRFxyXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxyXG4gICAqIEBwYXJhbSBlbnZcclxuICAgKi9cclxuICBwdWJsaWMgY3JlYXRlUGFnZXMgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHBhZ2VzOiBQYWdlRFRPLCB0cmFuc2FjdGlvbklkOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4ge1xyXG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdHJhbnNhY3Rpb25zL3t0cmFuc2FjdGlvbklkfS9wYWdlcydcclxuICAgICAgLnJlcGxhY2UoJ3snICsgJ3RyYW5zYWN0aW9uSWQnICsgJ30nLCBTdHJpbmcodHJhbnNhY3Rpb25JZCkpO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlUGFnZXMuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAncGFnZXMnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHBhZ2VzID09PSBudWxsIHx8IHBhZ2VzID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgcGFnZXMgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVQYWdlcy4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0cmFuc2FjdGlvbklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0cmFuc2FjdGlvbklkID09PSBudWxsIHx8IHRyYW5zYWN0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlUGFnZXMuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBjcmVhdGVQYWdlcy4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBxczogcXVlcnlQYXJhbWV0ZXJzLFxyXG4gICAgICBoZWFkZXJzOiBoZWFkZXJQYXJhbXMsXHJcbiAgICAgIHVyaTogbG9jYWxWYXJQYXRoLFxyXG4gICAgICB1c2VRdWVyeXN0cmluZzogdGhpcy5fdXNlUXVlcnlzdHJpbmcsXHJcbiAgICAgIGpzb246IHRydWUsXHJcbiAgICAgIGJvZHk6IHBhZ2VzLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBHZXRzIGEgbGlzdCBvZiB2YXJpYmFsZXMgYW5kIGFkZCB0aGVtIHRvIGFuIGV4aXN0aW5nIFRyYW5zYWN0aW9uLCBpZiB0aGUgVHJhbnNhY3Rpb24gbm90IGV4aXN0cyB3aWxsIHJldHVybiBIVFRQIGNvZGUgNDA0XHJcbiAgICogQHN1bW1hcnkgQ3JlYXRlcyB2YXJpYWJsZXMgZm9yIHNwZWNpZmljIHRyYW5zYWN0aW9uXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIHZhcmlhYmxlcyBMaXN0IG9mIHZhcmlhYmxlc1xyXG4gICAqIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElEXHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyBjcmVhdGVWYXJpYWJsZXMgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHZhcmlhYmxlczogVmFyaWFibGVEVE8sIHRyYW5zYWN0aW9uSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMve3RyYW5zYWN0aW9uSWR9L3ZhcmlhYmxlcydcclxuICAgICAgLnJlcGxhY2UoJ3snICsgJ3RyYW5zYWN0aW9uSWQnICsgJ30nLCBTdHJpbmcodHJhbnNhY3Rpb25JZCkpO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVmFyaWFibGVzLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3ZhcmlhYmxlcycgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodmFyaWFibGVzID09PSBudWxsIHx8IHZhcmlhYmxlcyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHZhcmlhYmxlcyB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGNyZWF0ZVZhcmlhYmxlcy4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0cmFuc2FjdGlvbklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0cmFuc2FjdGlvbklkID09PSBudWxsIHx8IHRyYW5zYWN0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVmFyaWFibGVzLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgY3JlYXRlVmFyaWFibGVzLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgICAgYm9keTogdmFyaWFibGVzLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBHZXRzIFRyYW5zYWN0aW9uIGJ5IGlkLCBpZiBub3QgZXhpc3RzIEhUVFAgY29kZSA0MDQgcmV0dXJuZWRcclxuICAgKiBAc3VtbWFyeSBSZWFkcyBzcGVjaWZpYyBUcmFuc2FjdGlvbiBmcm9tIFJEU1xyXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxyXG4gICAqIEBwYXJhbSB0cmFuc2FjdGlvbklkIFRyYW5zYWN0aW9uIElEXHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyBnZXRUcmFuc2FjdGlvbiAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgdHJhbnNhY3Rpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RyYW5zYWN0aW9ucy97dHJhbnNhY3Rpb25JZH0nXHJcbiAgICAgIC5yZXBsYWNlKCd7JyArICd0cmFuc2FjdGlvbklkJyArICd9JywgU3RyaW5nKHRyYW5zYWN0aW9uSWQpKTtcclxuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xyXG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xyXG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xyXG5cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldFRyYW5zYWN0aW9uLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RyYW5zYWN0aW9uSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRyYW5zYWN0aW9uSWQgPT09IG51bGwgfHwgdHJhbnNhY3Rpb25JZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRyYW5zYWN0aW9uSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbi4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldFRyYW5zYWN0aW9uLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBSZWFkcyByZXN1bHRzIGZyb20gUkRTIHVzaW5nIHRoZSBiYXRjaElkIHJldHVybmVkIGZyb20gJ09mZmxpbmUgcmVhZCBvZiBUcmFuc2FjdGlvbnMnICgvcmRzL2JhdGNoKVxyXG4gICAqIEBzdW1tYXJ5IEdldHMgdGhlIGJhdGNoIHJldHJpZXZlIHJlc3VsdHMgaW4gYSB6aXAgZmlsZVxyXG4gICAqIEBwYXJhbSBhcHBsaWNhdGlvbktleVxyXG4gICAqIEBwYXJhbSBiYXRjaElkIEJhdGNoIERcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gZW52XHJcbiAgICovXHJcbiAgcHVibGljIGdldFRyYW5zYWN0aW9uQmF0Y2hSZXN1bHQgKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIGJhdGNoSWQ6IHN0cmluZywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQXJyYXk8c3RyaW5nPjsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RyYW5zYWN0aW9ucy9yZXN1bHQve2JhdGNoSWR9J1xyXG4gICAgICAucmVwbGFjZSgneycgKyAnYmF0Y2hJZCcgKyAnfScsIFN0cmluZyhiYXRjaElkKSk7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbkJhdGNoUmVzdWx0LicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2JhdGNoSWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGJhdGNoSWQgPT09IG51bGwgfHwgYmF0Y2hJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGJhdGNoSWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBnZXRUcmFuc2FjdGlvbkJhdGNoUmVzdWx0LicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0VHJhbnNhY3Rpb25CYXRjaFJlc3VsdC4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5hdXRoZW50aWNhdGlvbnMuZGVmYXVsdC5hcHBseVRvUmVxdWVzdChyZXF1ZXN0T3B0aW9ucyk7XHJcblxyXG4gICAgaWYgKE9iamVjdC5rZXlzKGZvcm1QYXJhbXMpLmxlbmd0aCkge1xyXG4gICAgICBpZiAodXNlRm9ybURhdGEpIHtcclxuICAgICAgICAoPGFueT5yZXF1ZXN0T3B0aW9ucykuZm9ybURhdGEgPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmZvcm0gPSBmb3JtUGFyYW1zO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogQXJyYXk8c3RyaW5nPjsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBSZWFkcyBUcmFuc2FjdGlvbnMgZnJvbSBSRFMgYnkgdGltZSByYW5nZSwgY3VzdG9tZXIgaWQgb3IvYW5kIGV4dGVybmFsU3lzdGVtSWQsIGlmIGFsbCB0aGUgcGFyYW1ldGVycyBhcmUgZW1wdHkgd2lsbCByZWFkIGFsbCBUcmFuc2FjdGlvbnMuIEluIG90aCBjYXNlcyB0aGUgbWF4aW11bSByZXN1bHRzIGNhbiBiZSByZXRyaWV2ZWQgYnkgdGhpcyBBUEkgaXMgMTAwMCwgaWYgeW91IG5lZWQgdG8gcmV0cmlldmUgbW9yZSBwbGVhc2UgdXNlIHRoZSBiYXRjaCByZXRyaWV2ZSBBUEkgL3Jkcy9iYXRjaFxyXG4gICAqIEBzdW1tYXJ5IFJlYWRzIGxpc3Qgb2YgVHJhbnNhY3Rpb24gYnkgY3JpdGVyaWFcclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gdGltZUZyb20gVGhlIHN0YXJ0IHRpbWVcclxuICAgKiBAcGFyYW0gdGltZVRvIFRoZSBlbmQgdGltZVxyXG4gICAqIEBwYXJhbSBjdXN0b21lcklkIEN1c3RvbWVyIElEXHJcbiAgICogQHBhcmFtIGV4dGVybmFsU3lzdGVtSWQgRXh0ZXJuYWxTeXN0ZW0gSURcclxuICAgKiBAcGFyYW0gc291cmNlIFRyYW5zYWN0aW9uIHNvdXJjZVxyXG4gICAqIEBwYXJhbSBjYXRlZ29yeUlkIENhdGVnb3J5IElEXHJcbiAgICogQHBhcmFtIHZhcmlhYmxlcyBWYXJpYWJsZXMgbGlzdCB0byByZXRyaWV2ZSwgaWYgbm90IHBhc3NlZCBub3RoaW5nIHdpbGwgYmUgcmV0cmlldmVkLCBpZiBwYXNzIHRoZSBrZXl3b3JkICYjMzk7YWxsJiMzOTssIGFsbCB2YXJpYmFsZXMgd2lsbCBiZSByZXR1cm5lZFxyXG4gICAqIEBwYXJhbSBlbnZcclxuICAgKi9cclxuICBwdWJsaWMgZ2V0VHJhbnNhY3Rpb25zIChhcHBsaWNhdGlvbktleTogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCB0aW1lRnJvbT86IG51bWJlciwgdGltZVRvPzogbnVtYmVyLCBjdXN0b21lcklkPzogc3RyaW5nLCBleHRlcm5hbFN5c3RlbUlkPzogc3RyaW5nLCBzb3VyY2U/OiBzdHJpbmcsIGNhdGVnb3J5SWQ/OiBzdHJpbmcsIHZhcmlhYmxlcz86IE1vZGVsT2JqZWN0LCBlbnY/OiBzdHJpbmcpIDogUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBcnJheTxUcmFuc2FjdGlvbkRUTz47ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMnO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0VHJhbnNhY3Rpb25zLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RlbmFudElkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0ZW5hbnRJZCA9PT0gbnVsbCB8fCB0ZW5hbnRJZCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRlbmFudElkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0VHJhbnNhY3Rpb25zLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aW1lRnJvbSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1sndGltZUZyb20nXSA9IHRpbWVGcm9tO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aW1lVG8gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ3RpbWVUbyddID0gdGltZVRvO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjdXN0b21lcklkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgcXVlcnlQYXJhbWV0ZXJzWydjdXN0b21lcklkJ10gPSBjdXN0b21lcklkO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChleHRlcm5hbFN5c3RlbUlkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgcXVlcnlQYXJhbWV0ZXJzWydleHRlcm5hbFN5c3RlbUlkJ10gPSBleHRlcm5hbFN5c3RlbUlkO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ3NvdXJjZSddID0gc291cmNlO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChjYXRlZ29yeUlkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgcXVlcnlQYXJhbWV0ZXJzWydjYXRlZ29yeUlkJ10gPSBjYXRlZ29yeUlkO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh2YXJpYWJsZXMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ3ZhcmlhYmxlcyddID0gdmFyaWFibGVzO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBBcnJheTxUcmFuc2FjdGlvbkRUTz47ICB9PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIHJlcXVlc3QocmVxdWVzdE9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlID49IDIwMCAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDw9IDI5OSkge1xyXG4gICAgICAgICAgICByZXNvbHZlKHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KHsgcmVzcG9uc2U6IHJlc3BvbnNlLCBib2R5OiBib2R5IH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogVGhpcyBBUEkgcmVhZHMgVHJhbnNhY3Rpb25zIGFzeW5jaHJvbm91c2x5LCBhIGJhdGNoSWQgZ2VuZXJhdGVkIGFuZCByZXR1cm5lZCBpbW1lZGlhdGx5IHRvIHRoZSBjYWxsZXIgYXMgSFRUUCBoZWFkZXIsIHRoZW4gYW4gYXN5bmMgc2VydmljZSBjYWxsIHRvIHF1ZXJ5IHRoZSBUcmFuc2FjdGlvbnMgYnkgdGhlIHRpbWUgcmFuZ2UsIGN1c3RvbWVyIGlkIG9yL2FuZCBleHRlcm5hbFN5c3RlbUlkIGV4ZWN1dGVkIGFuZCBzdG9yZXMgdGhlIHJlc3VsdHMgdXNpbmcgdGhlIGJhdGNoSWQgZ2VuZXJhdGVkIGVhcmxpZXIsIHRoaXMgYmF0Y2hJZCB3aWxsIGJlIHVzZWQgbGF0ZXIgdG8gZ2V0IHRoZSBiYXRjaCBwcm9jZXNzaW5nIHJlc3VsdHNcclxuICAgKiBAc3VtbWFyeSBPZmZsaW5lIHJlYWQgb2YgVHJhbnNhY3Rpb25zXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIHRlbmFudElkXHJcbiAgICogQHBhcmFtIHRpbWVGcm9tIFRoZSBzdGFydCB0aW1lXHJcbiAgICogQHBhcmFtIHRpbWVUbyBUaGUgZW5kIHRpbWVcclxuICAgKiBAcGFyYW0gY3VzdG9tZXJJZCBDdXN0b21lciBJRFxyXG4gICAqIEBwYXJhbSBleHRlcm5hbFN5c3RlbUlkIEV4dGVybmFsU3lzdGVtIElEXHJcbiAgICogQHBhcmFtIHNvdXJjZSBUcmFuc2FjdGlvbiBzb3VyY2VcclxuICAgKiBAcGFyYW0gY2F0ZWdvcnlJZCBDYXRlZ29yeSBJRFxyXG4gICAqIEBwYXJhbSB2YXJpYWJsZXMgVmFyaWFibGVzIGxpc3QgdG8gcmV0cmlldmUsIGlmIG5vdCBwYXNzZWQgbm90aGluZyB3aWxsIGJlIHJldHJpZXZlZCwgaWYgcGFzcyB0aGUga2V5d29yZCAmIzM5O2FsbCYjMzk7LCBhbGwgdmFyaWJhbGVzIHdpbGwgYmUgcmV0dXJuZWRcclxuICAgKiBAcGFyYW0gZW52XHJcbiAgICovXHJcbiAgcHVibGljIGdldFRyYW5zYWN0aW9uc0luQmF0Y2ggKGFwcGxpY2F0aW9uS2V5OiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIHRpbWVGcm9tPzogbnVtYmVyLCB0aW1lVG8/OiBudW1iZXIsIGN1c3RvbWVySWQ/OiBzdHJpbmcsIGV4dGVybmFsU3lzdGVtSWQ/OiBzdHJpbmcsIHNvdXJjZT86IHN0cmluZywgY2F0ZWdvcnlJZD86IHN0cmluZywgdmFyaWFibGVzPzogTW9kZWxPYmplY3QsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IEJhdGNoUmVzcG9uc2U7ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMvYmF0Y2gnO1xyXG4gICAgbGV0IHF1ZXJ5UGFyYW1ldGVyczogYW55ID0ge307XHJcbiAgICBsZXQgaGVhZGVyUGFyYW1zOiBhbnkgPSAoPGFueT5PYmplY3QpLmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0SGVhZGVycyk7XHJcbiAgICBsZXQgZm9ybVBhcmFtczogYW55ID0ge307XHJcblxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ2FwcGxpY2F0aW9uS2V5JyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChhcHBsaWNhdGlvbktleSA9PT0gbnVsbCB8fCBhcHBsaWNhdGlvbktleSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIGFwcGxpY2F0aW9uS2V5IHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgZ2V0VHJhbnNhY3Rpb25zSW5CYXRjaC4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGdldFRyYW5zYWN0aW9uc0luQmF0Y2guJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRpbWVGcm9tICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgcXVlcnlQYXJhbWV0ZXJzWyd0aW1lRnJvbSddID0gdGltZUZyb207XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRpbWVUbyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1sndGltZVRvJ10gPSB0aW1lVG87XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGN1c3RvbWVySWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ2N1c3RvbWVySWQnXSA9IGN1c3RvbWVySWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGV4dGVybmFsU3lzdGVtSWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ2V4dGVybmFsU3lzdGVtSWQnXSA9IGV4dGVybmFsU3lzdGVtSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNvdXJjZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1snc291cmNlJ10gPSBzb3VyY2U7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGNhdGVnb3J5SWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ2NhdGVnb3J5SWQnXSA9IGNhdGVnb3J5SWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZhcmlhYmxlcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1sndmFyaWFibGVzJ10gPSB2YXJpYWJsZXM7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBCYXRjaFJlc3BvbnNlOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIEdldHMgYSBsaXN0IG9mIFRyYW5zYWN0aW9uRFRPcyBhbmQgbG9hZHMgdGhlbSBpbnRvIFJEUywgUkRTIGNyZWF0ZXMgVHJhbnNhY3Rpb24gZm9yIGVhY2ggRFRPIGluIHRoZSBsaXN0XHJcbiAgICogQHN1bW1hcnkgTG9hZHMgbGlzdCBvZiB0cmFuc2FjdGlvbnMgdG8gUkRTXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIHRyYW5zYWN0aW9ucyBMaXN0IG9mIHRyYW5zYWN0aW9uc1xyXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxyXG4gICAqIEBwYXJhbSBlbnZcclxuICAgKi9cclxuICBwdWJsaWMgbG9hZFRyYW5zYWN0aW9ucyAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgdHJhbnNhY3Rpb25zOiBUcmFuc2FjdGlvbkRUTywgdGVuYW50SWQ6IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keT86IGFueTsgIH0+IHtcclxuICAgIGNvbnN0IGxvY2FsVmFyUGF0aCA9IHRoaXMuYmFzZVBhdGggKyAnL3RyYW5zYWN0aW9ucyc7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBsb2FkVHJhbnNhY3Rpb25zLicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHZlcmlmeSByZXF1aXJlZCBwYXJhbWV0ZXIgJ3RyYW5zYWN0aW9ucycgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodHJhbnNhY3Rpb25zID09PSBudWxsIHx8IHRyYW5zYWN0aW9ucyA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgcGFyYW1ldGVyIHRyYW5zYWN0aW9ucyB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIGxvYWRUcmFuc2FjdGlvbnMuJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyBsb2FkVHJhbnNhY3Rpb25zLicpO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYWRlclBhcmFtc1snQXBwbGljYXRpb24tS2V5J10gPSBhcHBsaWNhdGlvbktleTtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ1RlbmFudC1JZCddID0gdGVuYW50SWQ7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydFbnYnXSA9IGVudjtcclxuXHJcbiAgICBsZXQgdXNlRm9ybURhdGEgPSBmYWxzZTtcclxuXHJcbiAgICBsZXQgcmVxdWVzdE9wdGlvbnM6IHJlcXVlc3QuT3B0aW9ucyA9IHtcclxuICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgICAgYm9keTogdHJhbnNhY3Rpb25zLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5PzogYW55OyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIFN0YXJ0cyBhIHRyYW5zYWN0aW9uIGFuZCByZXR1cm4gYW4gZW1wdHkgVHJhbnNhY3Rpb25EVE8gd2l0aCBpZCB0byB0aGUgY2FsbGVyLCBjYWxsZXIgYWxzbyBjYW4gc2VuZCB0aGUgZXh0ZXJuYWxTeXN0ZW1JZCB0byBiZSB1c2VkIGxhdGVyIHRvIGdldCB0cmFuc2FjdGlvbnNcclxuICAgKiBAc3VtbWFyeSBTdGFydHMgYSB0cmFuc2FjdGlvbiBpbiBSRFNcclxuICAgKiBAcGFyYW0gYXBwbGljYXRpb25LZXlcclxuICAgKiBAcGFyYW0gc291cmNlIFRyYW5zYWN0aW9uIHNvdXJjZVxyXG4gICAqIEBwYXJhbSB0ZW5hbnRJZFxyXG4gICAqIEBwYXJhbSBleHRlcm5hbFN5c3RlbUlkIEV4dGVybmFsIFN5c3RlbSBJRFxyXG4gICAqIEBwYXJhbSBlbnZcclxuICAgKi9cclxuICBwdWJsaWMgc3RhcnRUcmFuc2FjdGlvbiAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgc291cmNlOiBzdHJpbmcsIHRlbmFudElkOiBzdHJpbmcsIGV4dGVybmFsU3lzdGVtSWQ/OiBzdHJpbmcsIGVudj86IHN0cmluZykgOiBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4ge1xyXG4gICAgY29uc3QgbG9jYWxWYXJQYXRoID0gdGhpcy5iYXNlUGF0aCArICcvdHJhbnNhY3Rpb25zL3N0YXJ0JztcclxuICAgIGxldCBxdWVyeVBhcmFtZXRlcnM6IGFueSA9IHt9O1xyXG4gICAgbGV0IGhlYWRlclBhcmFtczogYW55ID0gKDxhbnk+T2JqZWN0KS5hc3NpZ24oe30sIHRoaXMuZGVmYXVsdEhlYWRlcnMpO1xyXG4gICAgbGV0IGZvcm1QYXJhbXM6IGFueSA9IHt9O1xyXG5cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICdhcHBsaWNhdGlvbktleScgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAoYXBwbGljYXRpb25LZXkgPT09IG51bGwgfHwgYXBwbGljYXRpb25LZXkgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciBhcHBsaWNhdGlvbktleSB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHN0YXJ0VHJhbnNhY3Rpb24uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnc291cmNlJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChzb3VyY2UgPT09IG51bGwgfHwgc291cmNlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgc291cmNlIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgc3RhcnRUcmFuc2FjdGlvbi4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0ZW5hbnRJZCcgaXMgbm90IG51bGwgb3IgdW5kZWZpbmVkXHJcbiAgICBpZiAodGVuYW50SWQgPT09IG51bGwgfHwgdGVuYW50SWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0ZW5hbnRJZCB3YXMgbnVsbCBvciB1bmRlZmluZWQgd2hlbiBjYWxsaW5nIHN0YXJ0VHJhbnNhY3Rpb24uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGV4dGVybmFsU3lzdGVtSWQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBxdWVyeVBhcmFtZXRlcnNbJ2V4dGVybmFsU3lzdGVtSWQnXSA9IGV4dGVybmFsU3lzdGVtSWQ7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHNvdXJjZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgIHF1ZXJ5UGFyYW1ldGVyc1snc291cmNlJ10gPSBzb3VyY2U7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydBcHBsaWNhdGlvbi1LZXknXSA9IGFwcGxpY2F0aW9uS2V5O1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snVGVuYW50LUlkJ10gPSB0ZW5hbnRJZDtcclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0VudiddID0gZW52O1xyXG5cclxuICAgIGxldCB1c2VGb3JtRGF0YSA9IGZhbHNlO1xyXG5cclxuICAgIGxldCByZXF1ZXN0T3B0aW9uczogcmVxdWVzdC5PcHRpb25zID0ge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgcXM6IHF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgaGVhZGVyczogaGVhZGVyUGFyYW1zLFxyXG4gICAgICB1cmk6IGxvY2FsVmFyUGF0aCxcclxuICAgICAgdXNlUXVlcnlzdHJpbmc6IHRoaXMuX3VzZVF1ZXJ5c3RyaW5nLFxyXG4gICAgICBqc29uOiB0cnVlLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmF1dGhlbnRpY2F0aW9ucy5kZWZhdWx0LmFwcGx5VG9SZXF1ZXN0KHJlcXVlc3RPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoT2JqZWN0LmtleXMoZm9ybVBhcmFtcykubGVuZ3RoKSB7XHJcbiAgICAgIGlmICh1c2VGb3JtRGF0YSkge1xyXG4gICAgICAgICg8YW55PnJlcXVlc3RPcHRpb25zKS5mb3JtRGF0YSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVxdWVzdE9wdGlvbnMuZm9ybSA9IGZvcm1QYXJhbXM7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTx7IHJlc3BvbnNlOiBodHRwLkNsaWVudFJlc3BvbnNlOyBib2R5OiBUcmFuc2FjdGlvbkRUTzsgIH0+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgcmVxdWVzdChyZXF1ZXN0T3B0aW9ucywgKGVycm9yLCByZXNwb25zZSwgYm9keSkgPT4ge1xyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgcmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPD0gMjk5KSB7XHJcbiAgICAgICAgICAgIHJlc29sdmUoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoeyByZXNwb25zZTogcmVzcG9uc2UsIGJvZHk6IGJvZHkgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBVcGRhdGVzIHNwZWNpZmljIFRyYW5zYWN0aW9uIGluIFJEUyB1c2luZyB0aGUgdHJhbnNhY3Rpb24gaWQgYW5kIHVwZGF0ZWQgVHJhbnNhY3Rpb25EVE8sIEhUVFAgY29kZSA0MDQgcmV0dXJuZWQgaWYgdGhlIFRyYW5zYWN0aW9uIG5vdCBleGlzdHNcclxuICAgKiBAc3VtbWFyeSBVcGRhdGVzIHNwZWNpZmljIHRyYW5zYWN0aW9uXHJcbiAgICogQHBhcmFtIGFwcGxpY2F0aW9uS2V5XHJcbiAgICogQHBhcmFtIHRyYW5zYWN0aW9uSWQgVHJhbnNhY3Rpb24gSURcclxuICAgKiBAcGFyYW0gdGVuYW50SWRcclxuICAgKiBAcGFyYW0gdHJhbnNhY3Rpb25EdG8gVHJhbnNhY3Rpb24gRFRPXHJcbiAgICogQHBhcmFtIGVudlxyXG4gICAqL1xyXG4gIHB1YmxpYyB1cGRhdGVUcmFuc2FjdGlvbiAoYXBwbGljYXRpb25LZXk6IHN0cmluZywgdHJhbnNhY3Rpb25JZDogc3RyaW5nLCB0ZW5hbnRJZDogc3RyaW5nLCB0cmFuc2FjdGlvbkR0bz86IHN0cmluZywgZW52Pzogc3RyaW5nKSA6IFByb21pc2U8eyByZXNwb25zZTogaHR0cC5DbGllbnRSZXNwb25zZTsgYm9keTogVHJhbnNhY3Rpb25EVE87ICB9PiB7XHJcbiAgICBjb25zdCBsb2NhbFZhclBhdGggPSB0aGlzLmJhc2VQYXRoICsgJy90cmFuc2FjdGlvbnMve3RyYW5zYWN0aW9uSWR9J1xyXG4gICAgICAucmVwbGFjZSgneycgKyAndHJhbnNhY3Rpb25JZCcgKyAnfScsIFN0cmluZyh0cmFuc2FjdGlvbklkKSk7XHJcbiAgICBsZXQgcXVlcnlQYXJhbWV0ZXJzOiBhbnkgPSB7fTtcclxuICAgIGxldCBoZWFkZXJQYXJhbXM6IGFueSA9ICg8YW55Pk9iamVjdCkuYXNzaWduKHt9LCB0aGlzLmRlZmF1bHRIZWFkZXJzKTtcclxuICAgIGxldCBmb3JtUGFyYW1zOiBhbnkgPSB7fTtcclxuXHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAnYXBwbGljYXRpb25LZXknIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKGFwcGxpY2F0aW9uS2V5ID09PSBudWxsIHx8IGFwcGxpY2F0aW9uS2V5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgYXBwbGljYXRpb25LZXkgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVUcmFuc2FjdGlvbi4nKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyB2ZXJpZnkgcmVxdWlyZWQgcGFyYW1ldGVyICd0cmFuc2FjdGlvbklkJyBpcyBub3QgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmICh0cmFuc2FjdGlvbklkID09PSBudWxsIHx8IHRyYW5zYWN0aW9uSWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlcXVpcmVkIHBhcmFtZXRlciB0cmFuc2FjdGlvbklkIHdhcyBudWxsIG9yIHVuZGVmaW5lZCB3aGVuIGNhbGxpbmcgdXBkYXRlVHJhbnNhY3Rpb24uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gdmVyaWZ5IHJlcXVpcmVkIHBhcmFtZXRlciAndGVuYW50SWQnIGlzIG5vdCBudWxsIG9yIHVuZGVmaW5lZFxyXG4gICAgaWYgKHRlbmFudElkID09PSBudWxsIHx8IHRlbmFudElkID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZXF1aXJlZCBwYXJhbWV0ZXIgdGVuYW50SWQgd2FzIG51bGwgb3IgdW5kZWZpbmVkIHdoZW4gY2FsbGluZyB1cGRhdGVUcmFuc2FjdGlvbi4nKTtcclxuICAgIH1cclxuXHJcbiAgICBoZWFkZXJQYXJhbXNbJ0FwcGxpY2F0aW9uLUtleSddID0gYXBwbGljYXRpb25LZXk7XHJcblxyXG4gICAgaGVhZGVyUGFyYW1zWydUZW5hbnQtSWQnXSA9IHRlbmFudElkO1xyXG5cclxuICAgIGhlYWRlclBhcmFtc1snRW52J10gPSBlbnY7XHJcblxyXG4gICAgbGV0IHVzZUZvcm1EYXRhID0gZmFsc2U7XHJcblxyXG4gICAgbGV0IHJlcXVlc3RPcHRpb25zOiByZXF1ZXN0Lk9wdGlvbnMgPSB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIHFzOiBxdWVyeVBhcmFtZXRlcnMsXHJcbiAgICAgIGhlYWRlcnM6IGhlYWRlclBhcmFtcyxcclxuICAgICAgdXJpOiBsb2NhbFZhclBhdGgsXHJcbiAgICAgIHVzZVF1ZXJ5c3RyaW5nOiB0aGlzLl91c2VRdWVyeXN0cmluZyxcclxuICAgICAganNvbjogdHJ1ZSxcclxuICAgICAgYm9keTogdHJhbnNhY3Rpb25EdG8sXHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuYXV0aGVudGljYXRpb25zLmRlZmF1bHQuYXBwbHlUb1JlcXVlc3QocmVxdWVzdE9wdGlvbnMpO1xyXG5cclxuICAgIGlmIChPYmplY3Qua2V5cyhmb3JtUGFyYW1zKS5sZW5ndGgpIHtcclxuICAgICAgaWYgKHVzZUZvcm1EYXRhKSB7XHJcbiAgICAgICAgKDxhbnk+cmVxdWVzdE9wdGlvbnMpLmZvcm1EYXRhID0gZm9ybVBhcmFtcztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXF1ZXN0T3B0aW9ucy5mb3JtID0gZm9ybVBhcmFtcztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPHsgcmVzcG9uc2U6IGh0dHAuQ2xpZW50UmVzcG9uc2U7IGJvZHk6IFRyYW5zYWN0aW9uRFRPOyAgfT4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICByZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCAoZXJyb3IsIHJlc3BvbnNlLCBib2R5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzQ29kZSA8PSAyOTkpIHtcclxuICAgICAgICAgICAgcmVzb2x2ZSh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJlamVjdCh7IHJlc3BvbnNlOiByZXNwb25zZSwgYm9keTogYm9keSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==